(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    102212,       1954]
NotebookOptionsPosition[     97717,       1867]
NotebookOutlinePosition[     98108,       1883]
CellTagsIndexPosition[     98065,       1880]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Increment Implementation", "Section",
 CellChangeTimes->{{3.863519660808393*^9, 
  3.8635196668701773`*^9}},ExpressionUUID->"4b052983-f7eb-4c60-b94e-\
63384307ec0d"],

Cell[CellGroupData[{

Cell["CA Base Functions", "Subsection",
 CellChangeTimes->{{3.8635194098090143`*^9, 
  3.863519411852273*^9}},ExpressionUUID->"4c8aaee8-1ce5-4656-857a-\
0898d5b45ada"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"randomly", " ", "select", " ", "a", " ", "rule"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"getRule", "[", 
     RowBox[{"k_", ",", " ", "r_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", 
       RowBox[{
        RowBox[{"k", "^", 
         RowBox[{"k", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "r"}], "+", "1"}], ")"}]}]}], " ", "-", " ", 
        "1"}]}], "}"}], "]"}]}], "\n", "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "all", " ", "blocks", " ", "of", " ", "cells", " ", "in", " ", "the", " ",
      "rule"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getBlocks", "[", 
     RowBox[{"k_", ",", " ", "r_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", " ", 
         RowBox[{"k", "-", "1"}], ",", " ", "1"}], "]"}], "]"}], ",", " ", 
      RowBox[{
       RowBox[{"2", "*", "r"}], "+", "1"}]}], "]"}]}], " ", "\n", "\t", "\n", 
   
   RowBox[{"(*", " ", 
    RowBox[{
    "rule", " ", "in", " ", "base", " ", "of", " ", "#", " ", "colors"}], " ",
     "*)"}], "\n", 
   RowBox[{
    RowBox[{"ruleDigits", "[", 
     RowBox[{"n_", ",", " ", "k_", ",", " ", "r_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ruleDigits", "[", 
      RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "]"}], "=", "\n", "\t", 
     RowBox[{"IntegerDigits", "[", 
      RowBox[{"n", ",", " ", "k", ",", " ", 
       RowBox[{"k", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "*", "r"}], "+", "1"}], ")"}]}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "\t", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "ratio", " ", "of", " ", "uncompressed", " ", "to", " ", "compressed", 
      " ", "size", " ", "of", " ", "CA"}], ",", " ", 
     RowBox[{"good", " ", "measure", " ", "for", " ", "classification"}]}], 
    " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"compressionRatio", "[", "ca_", "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ByteCount", "[", "ca", "]"}], "/", 
       RowBox[{"ByteCount", "[", 
        RowBox[{"Compress", "[", "ca", "]"}], "]"}]}], ",", " ", "4"}], 
     "]"}]}], " ", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "measure", " ", "of", " ", "difference", " ", "between", " ", "rules", 
      " ", "by", " ", "summing", " ", "squares", " ", "of", " ", 
      "differences", " ", "between", " ", "rule", " ", "applications"}], " ", 
     "-", " ", 
     RowBox[{"currently", " ", "unused"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"difference", "[", 
     RowBox[{"rule_", ",", "newRule_"}], "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"countUses", "[", "rule", "]"}], "-", 
       RowBox[{"countUses", "[", "newRule", "]"}]}], "]"}], "]"}], 
    " "}]}]}]], "Code",
 CellChangeTimes->{{3.770482787643997*^9, 3.770482921097328*^9}, {
   3.770482959794046*^9, 3.770483062443226*^9}, {3.770483139105879*^9, 
   3.770483142791513*^9}, {3.7704833713411627`*^9, 3.770483604393207*^9}, {
   3.770483652477036*^9, 3.770483668514173*^9}, {3.7704837314588003`*^9, 
   3.770483760241007*^9}, {3.77048379348855*^9, 3.770483818784292*^9}, {
   3.770483886037365*^9, 3.77048391704599*^9}, {3.770483982730173*^9, 
   3.770484041007475*^9}, {3.77048412028379*^9, 3.7704841228226023`*^9}, {
   3.770484218139017*^9, 3.770484239373794*^9}, {3.7704842830675592`*^9, 
   3.770484335072513*^9}, {3.770484689868153*^9, 3.770484707338176*^9}, {
   3.7704858240605583`*^9, 3.77048583343545*^9}, {3.77048590141014*^9, 
   3.770485901723312*^9}, {3.770486365317235*^9, 3.7704863665313587`*^9}, 
   3.770494386502613*^9, {3.770494470707664*^9, 3.770494645630993*^9}, {
   3.770494689386427*^9, 3.770494765588149*^9}, {3.7704948516503*^9, 
   3.770494888375936*^9}, {3.770494921269123*^9, 3.770495029608489*^9}, {
   3.7704950624466133`*^9, 3.770495141583098*^9}, {3.77049519230225*^9, 
   3.7704952643574133`*^9}, {3.770495449922097*^9, 3.7704955008340197`*^9}, {
   3.770495564766152*^9, 3.770495578779191*^9}, {3.770495620880939*^9, 
   3.770495654324613*^9}, 3.770546148986672*^9, 3.7705464136378736`*^9, {
   3.7705464597370453`*^9, 3.770546469723206*^9}, {3.770546510288927*^9, 
   3.770546531072365*^9}, {3.7705499059866543`*^9, 3.7705499209635277`*^9}, {
   3.770646995775899*^9, 3.770647162029993*^9}, {3.770647226016552*^9, 
   3.7706472960607977`*^9}, {3.770647344322225*^9, 3.770647427912814*^9}, {
   3.7706474763262453`*^9, 3.7706475285312357`*^9}, {3.770647579226934*^9, 
   3.7706475825076523`*^9}, {3.770647635720187*^9, 3.770647641473075*^9}, {
   3.770647712413559*^9, 3.77064771712294*^9}, {3.770647863127544*^9, 
   3.770647865474045*^9}, {3.770648147609572*^9, 3.7706481483061523`*^9}, {
   3.770648194531769*^9, 3.77064819764957*^9}, {3.7706482295255404`*^9, 
   3.770648251796324*^9}, {3.770648285676703*^9, 3.770648287071795*^9}, {
   3.7706483844894037`*^9, 3.770648408310869*^9}, {3.770648474457296*^9, 
   3.77064849181185*^9}, {3.77064919951954*^9, 3.770649219260521*^9}, {
   3.771012572080574*^9, 3.771012574557795*^9}, {3.7710130892382*^9, 
   3.7710131278577003`*^9}, {3.771013164671421*^9, 3.771013170662612*^9}, {
   3.771013241398697*^9, 3.771013293093876*^9}, {3.771013376828169*^9, 
   3.771013408917551*^9}, {3.771066027911306*^9, 3.7710660563644667`*^9}, {
   3.771066088967906*^9, 3.771066126393922*^9}, {3.771066304209084*^9, 
   3.771066417760647*^9}, {3.7710665061651993`*^9, 3.77106651827633*^9}, {
   3.7710665958461657`*^9, 3.771066599592246*^9}, {3.771066787106886*^9, 
   3.77106688118673*^9}, {3.771066917958227*^9, 3.771066920163258*^9}, {
   3.771066961041355*^9, 3.7710669697386007`*^9}, {3.771067019870351*^9, 
   3.771067054186266*^9}, {3.771067596745988*^9, 3.771067608539199*^9}, {
   3.7710677999321203`*^9, 3.771067828462199*^9}, {3.7710691448181763`*^9, 
   3.771069146191324*^9}, {3.771069401140826*^9, 3.7710694192296677`*^9}, {
   3.7710694544712057`*^9, 3.77106946175102*^9}, {3.771069510407185*^9, 
   3.771069546377035*^9}, {3.771069588713119*^9, 3.771069623729661*^9}, {
   3.7710777912034283`*^9, 3.771077797514872*^9}, {3.771077857747775*^9, 
   3.771077896683793*^9}, {3.7710779846984587`*^9, 3.7710780571582336`*^9}, {
   3.7710780916296473`*^9, 3.771078093185443*^9}, {3.771078157306479*^9, 
   3.7710783469069242`*^9}, {3.771078546205811*^9, 3.771078555275388*^9}, 
   3.771078785346652*^9, {3.771079086436943*^9, 3.771079086531608*^9}, {
   3.7710792132061577`*^9, 3.771079264419251*^9}, {3.7710796746024218`*^9, 
   3.77107985049893*^9}, {3.771079980556774*^9, 3.77108000254884*^9}, {
   3.771080037566615*^9, 3.771080126810281*^9}, {3.7710801647208*^9, 
   3.7710801660741787`*^9}, {3.771080197507674*^9, 3.7710802250598183`*^9}, {
   3.771080267960541*^9, 3.771080359083398*^9}, {3.771080406249712*^9, 
   3.771080421234771*^9}, {3.7710804782287493`*^9, 3.771080592180871*^9}, {
   3.7710806420884533`*^9, 3.771080643782098*^9}, {3.771080707357484*^9, 
   3.7710807526840153`*^9}, {3.771080786460499*^9, 3.7710807865927343`*^9}, {
   3.771080854778215*^9, 3.77108095974751*^9}, {3.7710810202456903`*^9, 
   3.771081023112467*^9}, {3.771081074111945*^9, 3.7710810835969048`*^9}, {
   3.7710813979098043`*^9, 3.771081432278171*^9}, {3.771081466981485*^9, 
   3.7710814671031923`*^9}, {3.771081505139979*^9, 3.771081583240635*^9}, {
   3.771081685649589*^9, 3.771081701105802*^9}, {3.771081759414233*^9, 
   3.771081781046382*^9}, {3.771081920400188*^9, 3.771081923433948*^9}, {
   3.771102715133277*^9, 3.7711027957900267`*^9}, {3.771102842399693*^9, 
   3.771102881808381*^9}, {3.771102929227768*^9, 3.7711029691401367`*^9}, {
   3.771103073447472*^9, 3.771103086180725*^9}, {3.7711031176933737`*^9, 
   3.771103123767542*^9}, {3.7711031660546627`*^9, 3.7711031834026413`*^9}, {
   3.7711032291580553`*^9, 3.7711034631767817`*^9}, {3.771103551409133*^9, 
   3.7711035565488443`*^9}, {3.771103589768116*^9, 3.771103643377743*^9}, {
   3.771104123721092*^9, 3.7711041535912523`*^9}, 3.7711042972171087`*^9, {
   3.771104442098654*^9, 3.7711044613789263`*^9}, {3.77110469507471*^9, 
   3.771104742941822*^9}, {3.771104774170217*^9, 3.77110482732683*^9}, {
   3.771155075730083*^9, 3.77115510319302*^9}, {3.7711552204793873`*^9, 
   3.771155256265522*^9}, {3.771155315803068*^9, 3.771155317177318*^9}, {
   3.771155352667796*^9, 3.7711554504442596`*^9}, {3.771155487442925*^9, 
   3.771155490673388*^9}, {3.771155532866001*^9, 3.7711555903371677`*^9}, {
   3.771155628649703*^9, 3.771155834814893*^9}, {3.7711558698054256`*^9, 
   3.7711559269158163`*^9}, 3.7711559705399923`*^9, {3.771156007382532*^9, 
   3.771156011094149*^9}, {3.771156048765955*^9, 3.771156049264926*^9}, {
   3.771156096767069*^9, 3.771156096825408*^9}, {3.7711561514908113`*^9, 
   3.77115623471835*^9}, {3.771156280227399*^9, 3.771156289782609*^9}, {
   3.771156373415247*^9, 3.7711563734818172`*^9}, {3.771156419112504*^9, 
   3.771156440871361*^9}, {3.771156495007992*^9, 3.7711565545108624`*^9}, {
   3.771156592609713*^9, 3.7711565927161903`*^9}, {3.771156768188053*^9, 
   3.771156795051096*^9}, 3.771156999731532*^9, {3.771157045274468*^9, 
   3.771157045541771*^9}, {3.771157114755713*^9, 3.771157137928946*^9}, 
   3.7711600338876333`*^9, {3.771242096819364*^9, 3.771242126195787*^9}, {
   3.771242256031309*^9, 3.771242258590022*^9}, {3.771242409531823*^9, 
   3.771242427172946*^9}, {3.771242887847391*^9, 3.7712430086268187`*^9}, 
   3.7712430584239273`*^9, {3.771243106934415*^9, 3.771243107568427*^9}, {
   3.7712431714277573`*^9, 3.771243197952642*^9}, {3.771244552432255*^9, 
   3.771244577042035*^9}, {3.77142514036493*^9, 3.771425142502884*^9}, {
   3.7714251943895397`*^9, 3.771425215829914*^9}, {3.77142527264194*^9, 
   3.7714253037709*^9}, {3.771425370795764*^9, 3.771425408257433*^9}, {
   3.771425440099287*^9, 3.7714254402688704`*^9}, {3.771425473750928*^9, 
   3.7714255960830173`*^9}, {3.771425631818544*^9, 3.771425675253339*^9}, {
   3.771425719721884*^9, 3.771425740883687*^9}, {3.77142580515589*^9, 
   3.7714258447466307`*^9}, {3.771425981145659*^9, 3.771426077771694*^9}, {
   3.771426125827806*^9, 3.771426127166316*^9}, {3.7714261869034653`*^9, 
   3.77142620723772*^9}, {3.7714262758003807`*^9, 3.77142627714293*^9}, {
   3.771426320226757*^9, 3.771426324649633*^9}, {3.771426394553677*^9, 
   3.771426422846036*^9}, {3.7714264814633904`*^9, 3.771426484560677*^9}, {
   3.7714265255888844`*^9, 3.77142656450191*^9}, {3.77142666832382*^9, 
   3.771426701226253*^9}, {3.7714267992888727`*^9, 3.771426802098439*^9}, {
   3.771426837696424*^9, 3.77142684252494*^9}, {3.771426881502282*^9, 
   3.77142689463704*^9}, {3.771426944474209*^9, 3.771426954837367*^9}, {
   3.771427085611624*^9, 3.771427208321937*^9}, {3.77142725982743*^9, 
   3.771427342676564*^9}, {3.771427387096983*^9, 3.77142741387674*^9}, {
   3.7714274823067417`*^9, 3.771427620083233*^9}, {3.771427650958089*^9, 
   3.771427735642126*^9}, {3.771427811732935*^9, 3.7714278281384907`*^9}, {
   3.771427984750801*^9, 3.771428010767819*^9}, {3.771428145789899*^9, 
   3.771428219232523*^9}, {3.77142845337399*^9, 3.771428832443232*^9}, {
   3.77142919635216*^9, 3.7714292167538853`*^9}, {3.771429255809939*^9, 
   3.771429255862849*^9}, {3.771429324211997*^9, 3.771429324566071*^9}, {
   3.771429398212832*^9, 3.771429402512352*^9}, {3.771429442429163*^9, 
   3.7714294540990467`*^9}, 3.7714294941500063`*^9, {3.771429539657894*^9, 
   3.7714295405513687`*^9}, {3.771429618724918*^9, 3.771429623261997*^9}, {
   3.7714307899835873`*^9, 3.771430790436494*^9}, 3.771451104216363*^9, {
   3.771508095448917*^9, 3.771508110132432*^9}, {3.7715083225896187`*^9, 
   3.7715083306779222`*^9}, {3.771508374776663*^9, 3.771508386277514*^9}, {
   3.7715084270778646`*^9, 3.771508512389296*^9}, 3.771508543555127*^9, {
   3.77150858570796*^9, 3.771508618994934*^9}, {3.7715088207169943`*^9, 
   3.77150889031539*^9}, {3.771508923322143*^9, 3.771508923670087*^9}, 
   3.771508953753009*^9, 3.771509016175152*^9, 3.7715091247344227`*^9, {
   3.771509280836137*^9, 3.7715093899531307`*^9}, {3.771509422527775*^9, 
   3.771509422567185*^9}, {3.771509493986957*^9, 3.7715096052550087`*^9}, {
   3.771509653971591*^9, 3.771509693979186*^9}, {3.77150973259478*^9, 
   3.77150990173524*^9}, {3.771510004414825*^9, 3.771510008024968*^9}, 
   3.771510097994895*^9, 3.771510166795833*^9, 3.771510435525115*^9, {
   3.771510592878343*^9, 3.7715105957468767`*^9}, {3.7715107677541*^9, 
   3.771510769561739*^9}, {3.77151081284661*^9, 3.7715108155415583`*^9}, {
   3.7715108821134987`*^9, 3.7715109302915382`*^9}, {3.771510964009658*^9, 
   3.771510971129046*^9}, {3.771511010046406*^9, 3.7715110353755198`*^9}, {
   3.771511088136096*^9, 3.771511102886223*^9}, {3.7715114300949583`*^9, 
   3.771511430126233*^9}, {3.771511497625127*^9, 3.7715115693777018`*^9}, {
   3.771511643172413*^9, 3.771511646783353*^9}, {3.771511678993891*^9, 
   3.771511680277672*^9}, 3.7715127192809067`*^9, {3.771512800048661*^9, 
   3.7715128026246967`*^9}, {3.771512870902679*^9, 3.771512913650139*^9}, {
   3.7715133261672697`*^9, 3.7715133314839773`*^9}, 3.771513492252378*^9, {
   3.771514518198213*^9, 3.7715145227679043`*^9}, {3.77151708493652*^9, 
   3.771517087523554*^9}, {3.771517126782735*^9, 3.771517128810008*^9}, {
   3.771517210341956*^9, 3.7715172460665407`*^9}, {3.771517282285139*^9, 
   3.7715173175659246`*^9}, {3.771517350871862*^9, 3.771517380625053*^9}, {
   3.7715175364523573`*^9, 3.77151760571542*^9}, {3.771517640074253*^9, 
   3.7715176411021967`*^9}, {3.7715176899659986`*^9, 3.771517690090538*^9}, {
   3.7715177712211246`*^9, 3.771517772849249*^9}, 3.7715179959744*^9, {
   3.771518135783963*^9, 3.771518137899392*^9}, {3.7715184814367847`*^9, 
   3.771518486933831*^9}, {3.771518845518941*^9, 3.771518853375394*^9}, {
   3.771519841748459*^9, 3.771519843226256*^9}, {3.771520014828779*^9, 
   3.771520023308147*^9}, {3.771520059011042*^9, 3.7715201019782476`*^9}, {
   3.771520273028158*^9, 3.771520279593449*^9}, {3.771520883693551*^9, 
   3.7715208856464148`*^9}, {3.771520929250544*^9, 3.771520982269124*^9}, {
   3.771521188240921*^9, 3.771521191230611*^9}, {3.7715215916037903`*^9, 
   3.7715216236153183`*^9}, {3.7715219556354227`*^9, 
   3.7715219569119167`*^9}, {3.7715219940893173`*^9, 3.771522004818063*^9}, {
   3.771522127564417*^9, 3.771522133178886*^9}, {3.771522237696827*^9, 
   3.771522242483397*^9}, {3.771522476907035*^9, 3.7715224806870003`*^9}, {
   3.771612023511445*^9, 3.771612031753702*^9}, {3.771612079472707*^9, 
   3.7716120893051157`*^9}, {3.7716224793342648`*^9, 3.771622480136241*^9}, {
   3.771622883240336*^9, 3.7716228933155813`*^9}, {3.7716237449938374`*^9, 
   3.771623747126918*^9}, {3.771623796412709*^9, 3.771623799136798*^9}, {
   3.771624309956813*^9, 3.771624313155792*^9}, {3.7716243671319427`*^9, 
   3.771624385215858*^9}, {3.7716254457528887`*^9, 3.7716254552861023`*^9}, {
   3.77162627898118*^9, 3.771626290997555*^9}, {3.771626471915455*^9, 
   3.77162647431002*^9}, {3.771673175223734*^9, 3.771673224278071*^9}, {
   3.771673266441729*^9, 3.77167327762712*^9}, {3.771673352316105*^9, 
   3.771673358322695*^9}, {3.77167341370112*^9, 3.771673438464848*^9}, {
   3.77167350121453*^9, 3.771673525509131*^9}, {3.771673569348257*^9, 
   3.771673571015792*^9}, {3.771673621462082*^9, 3.771673654459712*^9}, {
   3.771673971590723*^9, 3.771673978668692*^9}, 3.7716741398792048`*^9, {
   3.7716743853006973`*^9, 3.7716744014626913`*^9}, 3.7716744754869757`*^9, {
   3.771674530543592*^9, 3.771674536953731*^9}, {3.771674606489312*^9, 
   3.771674718727125*^9}, {3.7716753405724497`*^9, 3.7716754333285303`*^9}, {
   3.771675677951398*^9, 3.771675732879408*^9}, {3.7716934952658777`*^9, 
   3.771693620671177*^9}, {3.771693675046061*^9, 3.771693728576635*^9}, {
   3.771693781310905*^9, 3.771693883952346*^9}, {3.771694119731741*^9, 
   3.771694149933621*^9}, {3.771694304010154*^9, 3.771694425887899*^9}, {
   3.771694474334434*^9, 3.771694494910709*^9}, {3.771694596704371*^9, 
   3.771694598251622*^9}, {3.7716948351254873`*^9, 3.771694920695097*^9}, {
   3.771694969267427*^9, 3.7716949698444967`*^9}, {3.771695031505924*^9, 
   3.771695113745822*^9}, 3.771695177835884*^9, {3.771695213958036*^9, 
   3.771695266066115*^9}, {3.7716954041134243`*^9, 3.771695410898822*^9}, {
   3.771695583126212*^9, 3.771695583229229*^9}, {3.77169977478448*^9, 
   3.771699791270179*^9}, {3.771699867500791*^9, 3.771699871576948*^9}, {
   3.7716999020934553`*^9, 3.771699906117627*^9}, {3.771699974950583*^9, 
   3.771699998868513*^9}, {3.771700029172598*^9, 3.771700059110957*^9}, {
   3.7717001316852818`*^9, 3.771700133480904*^9}, {3.7717001952221823`*^9, 
   3.771700217684945*^9}, {3.771700511884554*^9, 3.771700552476619*^9}, {
   3.771700592591902*^9, 3.771700596013958*^9}, {3.771700698821248*^9, 
   3.7717007012138844`*^9}, {3.771700772107574*^9, 3.771700809173306*^9}, {
   3.77170086753579*^9, 3.77170087085679*^9}, {3.7717009850100393`*^9, 
   3.771701009678179*^9}, {3.7717010664161863`*^9, 3.771701196333969*^9}, {
   3.771701254320465*^9, 3.771701280334656*^9}, {3.77170131268221*^9, 
   3.771701327175708*^9}, {3.7717014657292233`*^9, 3.771701474742733*^9}, {
   3.77170154752151*^9, 3.771701620553605*^9}, {3.771701662420892*^9, 
   3.771701666119358*^9}, {3.771701715617041*^9, 3.771701749865892*^9}, {
   3.771701807376012*^9, 3.7717019223061943`*^9}, {3.771701966969564*^9, 
   3.771701980769197*^9}, {3.771702186095017*^9, 3.771702248928144*^9}, {
   3.771702825562228*^9, 3.771702903638236*^9}, {3.77170297868432*^9, 
   3.771703006267295*^9}, {3.77170332595191*^9, 3.771703351048498*^9}, 
   3.771703613336029*^9, {3.771703648586445*^9, 3.771703667688582*^9}, {
   3.7717037613927603`*^9, 3.771703763946455*^9}, {3.771703934107439*^9, 
   3.771703970399081*^9}, {3.771704119521832*^9, 3.771704151626587*^9}, {
   3.771704195880794*^9, 3.7717041970978518`*^9}, {3.77170455487595*^9, 
   3.771704596558196*^9}, 3.7717047518764133`*^9, {3.7717048365757103`*^9, 
   3.771704861086286*^9}, {3.771704923946967*^9, 3.771704924378716*^9}, 
   3.771704958834386*^9, {3.7717052012613983`*^9, 3.771705202921657*^9}, {
   3.771705240706903*^9, 3.771705291514925*^9}, {3.771705351887005*^9, 
   3.771705367591695*^9}, {3.7717054514478073`*^9, 3.771705464332407*^9}, {
   3.771705497687747*^9, 3.771705506523614*^9}, {3.7717081154580173`*^9, 
   3.771708127804226*^9}, {3.771709391190151*^9, 3.771709392741667*^9}, {
   3.771709499221224*^9, 3.7717095408582783`*^9}, {3.77170957137186*^9, 
   3.771709580184259*^9}, 3.771709635126422*^9, {3.771709706659088*^9, 
   3.7717097100094347`*^9}, {3.771712044671608*^9, 3.7717120455787354`*^9}, 
   3.771712139459732*^9, {3.771712358500682*^9, 3.7717123756141768`*^9}, {
   3.771712436664987*^9, 3.771712509584537*^9}, {3.771712637639783*^9, 
   3.771712648272489*^9}, {3.771712855559021*^9, 3.7717130514849358`*^9}, {
   3.771713084425671*^9, 3.7717131090809507`*^9}, {3.771713141844676*^9, 
   3.771713141969996*^9}, {3.7717132111494617`*^9, 3.7717132253991823`*^9}, {
   3.7717132768409567`*^9, 3.771713278696121*^9}, {3.771713312163457*^9, 
   3.771713313456105*^9}, {3.771713344789674*^9, 3.771713445916922*^9}, {
   3.771714152460678*^9, 3.77171427170189*^9}, {3.771714446749147*^9, 
   3.77171446965423*^9}, 3.771715082386012*^9, 3.7717154473600492`*^9, {
   3.7717712099257917`*^9, 3.771771249706091*^9}, {3.771771286705309*^9, 
   3.7717712887761602`*^9}, {3.863519384611875*^9, 3.8635195225175533`*^9}, 
   3.863519599102813*^9, {3.8635196965982733`*^9, 3.863519730939492*^9}, {
   3.8635200253457336`*^9, 3.863520029576379*^9}, {3.863521112861341*^9, 
   3.863521173121719*^9}, {3.863521415429288*^9, 3.8635214162318*^9}, {
   3.86352168377351*^9, 3.863521773165421*^9}, {3.863522079596251*^9, 
   3.863522089794454*^9}, {3.863522546211979*^9, 3.863522549995343*^9}, {
   3.863525010323978*^9, 3.863525011105337*^9}, {3.863702007946673*^9, 
   3.8637021684654016`*^9}, {3.863702206411743*^9, 3.863702220854912*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"85630bd6-46aa-4713-81d1-94737fa182d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rule Incrementing Functions", "Subsection",
 CellChangeTimes->{{3.863519532936678*^9, 
  3.863519537542882*^9}},ExpressionUUID->"6cfa4382-e90d-462a-88b8-\
9a50eed0f152"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "change", " ", "the", " ", "color", " ", "of", " ", "one", " ", 
    "replacement", " ", "from", " ", "the", " ", "rule"}], " ", "*)"}], "\n", 
  
  RowBox[{
   RowBox[{
    RowBox[{"ruleShift", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n_", ",", " ", "k_", ",", " ", "r_"}], "}"}], ",", " ", 
      "block_", ",", " ", "shift_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ruleShift", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "}"}], ",", " ", "block",
        ",", " ", "shift"}], "]"}], "=", "\n", "\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ruleLen", " ", "=", " ", 
         RowBox[{"k", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "*", "r"}], "+", "1"}], ")"}]}]}], "}"}], ",", "\n", 
       "\t\t", 
       RowBox[{"{", "\n", "\t\t", 
        RowBox[{
         RowBox[{"FromDigits", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"IntegerDigits", "[", 
               RowBox[{"n", ",", " ", "k", ",", " ", "ruleLen"}], "]"}], " ", 
              "+", " ", 
              RowBox[{"SparseArray", "[", 
               RowBox[{
                RowBox[{"block", "\[Rule]", "shift"}], ",", " ", "ruleLen"}], 
               "]"}]}], ",", " ", "k"}], "]"}], ",", " ", "k"}], "]"}], ",", 
         "\n", "\t\t", "k", ",", " ", "r"}], "\n", "\t\t", "}"}]}], "\n", 
      "\t", "]"}]}]}], "\n", "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "count", " ", "uses", " ", "of", " ", "each", " ", "block", " ", "of", 
     " ", "the", " ", "rule", " ", "in", " ", "a", " ", "ca"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"countUses", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n_", ",", " ", "k_", ",", " ", "r_"}], "}"}], ",", " ", 
      "init_", ",", " ", "size_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"countUses", "[", 
      RowBox[{"{", 
       RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "}"}], "]"}], "=", "\n", 
     "\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{
       RowBox[{"Counts", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"CellularAutomaton", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "}"}], ",", " ", 
              "init", ",", " ", 
              RowBox[{"size", "-", "1"}]}], "]"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", 
              RowBox[{
               RowBox[{"2", "*", "r"}], "+", "1"}]}], "}"}]}], "]"}], ",", 
          " ", "2"}], "]"}], "]"}], ",", " ", 
       RowBox[{"getBlocks", "[", 
        RowBox[{"k", ",", " ", "r"}], "]"}], ",", " ", "0"}], "]"}]}]}], "\n",
    "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "order", " ", "of", " ", "blocks", " ", "to", " ", "be", " ", 
     "replaced"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"blockOrder", "[", 
     RowBox[{
     "ruleSpec_", ",", " ", "init_", ",", " ", "size_", ",", " ", "nBlocks_", 
      ",", " ", "distance_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{
     RowBox[{"Ordering", "[", 
      RowBox[{
       RowBox[{"countUses", "[", 
        RowBox[{"ruleSpec", ",", " ", "init", ",", " ", "size"}], "]"}], ",", 
       " ", 
       RowBox[{"nBlocks", " ", "+", " ", "distance"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"distance", " ", "+", " ", "1"}], " ", ";;"}], " ", "]"}], 
     "]"}]}], " ", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"shift", " ", "one", " ", "block", " ", "of", " ", "rule"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"blockShifts", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n_", ",", " ", "k_", ",", " ", "r_"}], "}"}], ",", " ", 
      "block_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"ruleShift", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "}"}], ",", " ", 
        "block", ",", " ", "#"}], "]"}], "&"}], " ", "/@", " ", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", " ", 
       RowBox[{"{", 
        RowBox[{"i", ",", " ", 
         RowBox[{"k", "-", "1"}]}], "}"}]}], "]"}]}]}], " ", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "make", " ", "a", " ", "tree", " ", "of", " ", "associations", " ", "for",
      " ", "all", " ", "specified", " ", "rule", " ", "replacements"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"ruleReplace", "[", 
     RowBox[{"ruleSpec_", ",", " ", 
      RowBox[{"{", "}"}]}], "]"}], ":=", "ruleSpec"}], "\n", 
   RowBox[{
    RowBox[{"ruleReplace", "[", 
     RowBox[{"ruleSpec_", ",", " ", "reps_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ruleSpec", " ", "\[Rule]", " ", 
        RowBox[{"iterateRules", "[", 
         RowBox[{"#", ",", " ", 
          RowBox[{"Rest", "[", "reps", "]"}]}], "]"}]}], "&"}], ",", " ", 
      RowBox[{"blockShifts", "[", 
       RowBox[{"ruleSpec", ",", " ", 
        RowBox[{"First", "[", "reps", "]"}]}], "]"}]}], "]"}]}], " ", 
   "\[IndentingNewLine]", "\n", "\n", "\t\t\t", "\n", "\t\t\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"final", " ", "function"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"iterateRule", "[", 
     RowBox[{
     "ruleSpec_", ",", " ", "init_", ",", " ", "size_", ",", " ", "nBlocks_", 
      ",", " ", "distance_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"ruleReplace", "[", 
     RowBox[{"ruleSpec", ",", " ", 
      RowBox[{"blockOrder", "[", 
       RowBox[{
       "ruleSpec", ",", " ", "init", ",", " ", "size", ",", " ", "nBlocks", 
        ",", " ", "distance"}], "]"}]}], "]"}]}], "\n", "\t"}]}]], "Code",
 CellChangeTimes->{{3.770482787643997*^9, 3.770482921097328*^9}, {
   3.770482959794046*^9, 3.770483062443226*^9}, {3.770483139105879*^9, 
   3.770483142791513*^9}, {3.7704833713411627`*^9, 3.770483604393207*^9}, {
   3.770483652477036*^9, 3.770483668514173*^9}, {3.7704837314588003`*^9, 
   3.770483760241007*^9}, {3.77048379348855*^9, 3.770483818784292*^9}, {
   3.770483886037365*^9, 3.77048391704599*^9}, {3.770483982730173*^9, 
   3.770484041007475*^9}, {3.77048412028379*^9, 3.7704841228226023`*^9}, {
   3.770484218139017*^9, 3.770484239373794*^9}, {3.7704842830675592`*^9, 
   3.770484335072513*^9}, {3.770484689868153*^9, 3.770484707338176*^9}, {
   3.7704858240605583`*^9, 3.77048583343545*^9}, {3.77048590141014*^9, 
   3.770485901723312*^9}, {3.770486365317235*^9, 3.7704863665313587`*^9}, 
   3.770494386502613*^9, {3.770494470707664*^9, 3.770494645630993*^9}, {
   3.770494689386427*^9, 3.770494765588149*^9}, {3.7704948516503*^9, 
   3.770494888375936*^9}, {3.770494921269123*^9, 3.770495029608489*^9}, {
   3.7704950624466133`*^9, 3.770495141583098*^9}, {3.77049519230225*^9, 
   3.7704952643574133`*^9}, {3.770495449922097*^9, 3.7704955008340197`*^9}, {
   3.770495564766152*^9, 3.770495578779191*^9}, {3.770495620880939*^9, 
   3.770495654324613*^9}, 3.770546148986672*^9, 3.7705464136378736`*^9, {
   3.7705464597370453`*^9, 3.770546469723206*^9}, {3.770546510288927*^9, 
   3.770546531072365*^9}, {3.7705499059866543`*^9, 3.7705499209635277`*^9}, {
   3.770646995775899*^9, 3.770647162029993*^9}, {3.770647226016552*^9, 
   3.7706472960607977`*^9}, {3.770647344322225*^9, 3.770647427912814*^9}, {
   3.7706474763262453`*^9, 3.7706475285312357`*^9}, {3.770647579226934*^9, 
   3.7706475825076523`*^9}, {3.770647635720187*^9, 3.770647641473075*^9}, {
   3.770647712413559*^9, 3.77064771712294*^9}, {3.770647863127544*^9, 
   3.770647865474045*^9}, {3.770648147609572*^9, 3.7706481483061523`*^9}, {
   3.770648194531769*^9, 3.77064819764957*^9}, {3.7706482295255404`*^9, 
   3.770648251796324*^9}, {3.770648285676703*^9, 3.770648287071795*^9}, {
   3.7706483844894037`*^9, 3.770648408310869*^9}, {3.770648474457296*^9, 
   3.77064849181185*^9}, {3.77064919951954*^9, 3.770649219260521*^9}, {
   3.771012572080574*^9, 3.771012574557795*^9}, {3.7710130892382*^9, 
   3.7710131278577003`*^9}, {3.771013164671421*^9, 3.771013170662612*^9}, {
   3.771013241398697*^9, 3.771013293093876*^9}, {3.771013376828169*^9, 
   3.771013408917551*^9}, {3.771066027911306*^9, 3.7710660563644667`*^9}, {
   3.771066088967906*^9, 3.771066126393922*^9}, {3.771066304209084*^9, 
   3.771066417760647*^9}, {3.7710665061651993`*^9, 3.77106651827633*^9}, {
   3.7710665958461657`*^9, 3.771066599592246*^9}, {3.771066787106886*^9, 
   3.77106688118673*^9}, {3.771066917958227*^9, 3.771066920163258*^9}, {
   3.771066961041355*^9, 3.7710669697386007`*^9}, {3.771067019870351*^9, 
   3.771067054186266*^9}, {3.771067596745988*^9, 3.771067608539199*^9}, {
   3.7710677999321203`*^9, 3.771067828462199*^9}, {3.7710691448181763`*^9, 
   3.771069146191324*^9}, {3.771069401140826*^9, 3.7710694192296677`*^9}, {
   3.7710694544712057`*^9, 3.77106946175102*^9}, {3.771069510407185*^9, 
   3.771069546377035*^9}, {3.771069588713119*^9, 3.771069623729661*^9}, {
   3.7710777912034283`*^9, 3.771077797514872*^9}, {3.771077857747775*^9, 
   3.771077896683793*^9}, {3.7710779846984587`*^9, 3.7710780571582336`*^9}, {
   3.7710780916296473`*^9, 3.771078093185443*^9}, {3.771078157306479*^9, 
   3.7710783469069242`*^9}, {3.771078546205811*^9, 3.771078555275388*^9}, 
   3.771078785346652*^9, {3.771079086436943*^9, 3.771079086531608*^9}, {
   3.7710792132061577`*^9, 3.771079264419251*^9}, {3.7710796746024218`*^9, 
   3.77107985049893*^9}, {3.771079980556774*^9, 3.77108000254884*^9}, {
   3.771080037566615*^9, 3.771080126810281*^9}, {3.7710801647208*^9, 
   3.7710801660741787`*^9}, {3.771080197507674*^9, 3.7710802250598183`*^9}, {
   3.771080267960541*^9, 3.771080359083398*^9}, {3.771080406249712*^9, 
   3.771080421234771*^9}, {3.7710804782287493`*^9, 3.771080592180871*^9}, {
   3.7710806420884533`*^9, 3.771080643782098*^9}, {3.771080707357484*^9, 
   3.7710807526840153`*^9}, {3.771080786460499*^9, 3.7710807865927343`*^9}, {
   3.771080854778215*^9, 3.77108095974751*^9}, {3.7710810202456903`*^9, 
   3.771081023112467*^9}, {3.771081074111945*^9, 3.7710810835969048`*^9}, {
   3.7710813979098043`*^9, 3.771081432278171*^9}, {3.771081466981485*^9, 
   3.7710814671031923`*^9}, {3.771081505139979*^9, 3.771081583240635*^9}, {
   3.771081685649589*^9, 3.771081701105802*^9}, {3.771081759414233*^9, 
   3.771081781046382*^9}, {3.771081920400188*^9, 3.771081923433948*^9}, {
   3.771102715133277*^9, 3.7711027957900267`*^9}, {3.771102842399693*^9, 
   3.771102881808381*^9}, {3.771102929227768*^9, 3.7711029691401367`*^9}, {
   3.771103073447472*^9, 3.771103086180725*^9}, {3.7711031176933737`*^9, 
   3.771103123767542*^9}, {3.7711031660546627`*^9, 3.7711031834026413`*^9}, {
   3.7711032291580553`*^9, 3.7711034631767817`*^9}, {3.771103551409133*^9, 
   3.7711035565488443`*^9}, {3.771103589768116*^9, 3.771103643377743*^9}, {
   3.771104123721092*^9, 3.7711041535912523`*^9}, 3.7711042972171087`*^9, {
   3.771104442098654*^9, 3.7711044613789263`*^9}, {3.77110469507471*^9, 
   3.771104742941822*^9}, {3.771104774170217*^9, 3.77110482732683*^9}, {
   3.771155075730083*^9, 3.77115510319302*^9}, {3.7711552204793873`*^9, 
   3.771155256265522*^9}, {3.771155315803068*^9, 3.771155317177318*^9}, {
   3.771155352667796*^9, 3.7711554504442596`*^9}, {3.771155487442925*^9, 
   3.771155490673388*^9}, {3.771155532866001*^9, 3.7711555903371677`*^9}, {
   3.771155628649703*^9, 3.771155834814893*^9}, {3.7711558698054256`*^9, 
   3.7711559269158163`*^9}, 3.7711559705399923`*^9, {3.771156007382532*^9, 
   3.771156011094149*^9}, {3.771156048765955*^9, 3.771156049264926*^9}, {
   3.771156096767069*^9, 3.771156096825408*^9}, {3.7711561514908113`*^9, 
   3.77115623471835*^9}, {3.771156280227399*^9, 3.771156289782609*^9}, {
   3.771156373415247*^9, 3.7711563734818172`*^9}, {3.771156419112504*^9, 
   3.771156440871361*^9}, {3.771156495007992*^9, 3.7711565545108624`*^9}, {
   3.771156592609713*^9, 3.7711565927161903`*^9}, {3.771156768188053*^9, 
   3.771156795051096*^9}, 3.771156999731532*^9, {3.771157045274468*^9, 
   3.771157045541771*^9}, {3.771157114755713*^9, 3.771157137928946*^9}, 
   3.7711600338876333`*^9, {3.771242096819364*^9, 3.771242126195787*^9}, {
   3.771242256031309*^9, 3.771242258590022*^9}, {3.771242409531823*^9, 
   3.771242427172946*^9}, {3.771242887847391*^9, 3.7712430086268187`*^9}, 
   3.7712430584239273`*^9, {3.771243106934415*^9, 3.771243107568427*^9}, {
   3.7712431714277573`*^9, 3.771243197952642*^9}, {3.771244552432255*^9, 
   3.771244577042035*^9}, {3.77142514036493*^9, 3.771425142502884*^9}, {
   3.7714251943895397`*^9, 3.771425215829914*^9}, {3.77142527264194*^9, 
   3.7714253037709*^9}, {3.771425370795764*^9, 3.771425408257433*^9}, {
   3.771425440099287*^9, 3.7714254402688704`*^9}, {3.771425473750928*^9, 
   3.7714255960830173`*^9}, {3.771425631818544*^9, 3.771425675253339*^9}, {
   3.771425719721884*^9, 3.771425740883687*^9}, {3.77142580515589*^9, 
   3.7714258447466307`*^9}, {3.771425981145659*^9, 3.771426077771694*^9}, {
   3.771426125827806*^9, 3.771426127166316*^9}, {3.7714261869034653`*^9, 
   3.77142620723772*^9}, {3.7714262758003807`*^9, 3.77142627714293*^9}, {
   3.771426320226757*^9, 3.771426324649633*^9}, {3.771426394553677*^9, 
   3.771426422846036*^9}, {3.7714264814633904`*^9, 3.771426484560677*^9}, {
   3.7714265255888844`*^9, 3.77142656450191*^9}, {3.77142666832382*^9, 
   3.771426701226253*^9}, {3.7714267992888727`*^9, 3.771426802098439*^9}, {
   3.771426837696424*^9, 3.77142684252494*^9}, {3.771426881502282*^9, 
   3.77142689463704*^9}, {3.771426944474209*^9, 3.771426954837367*^9}, {
   3.771427085611624*^9, 3.771427208321937*^9}, {3.77142725982743*^9, 
   3.771427342676564*^9}, {3.771427387096983*^9, 3.77142741387674*^9}, {
   3.7714274823067417`*^9, 3.771427620083233*^9}, {3.771427650958089*^9, 
   3.771427735642126*^9}, {3.771427811732935*^9, 3.7714278281384907`*^9}, {
   3.771427984750801*^9, 3.771428010767819*^9}, {3.771428145789899*^9, 
   3.771428219232523*^9}, {3.77142845337399*^9, 3.771428832443232*^9}, {
   3.77142919635216*^9, 3.7714292167538853`*^9}, {3.771429255809939*^9, 
   3.771429255862849*^9}, {3.771429324211997*^9, 3.771429324566071*^9}, {
   3.771429398212832*^9, 3.771429402512352*^9}, {3.771429442429163*^9, 
   3.7714294540990467`*^9}, 3.7714294941500063`*^9, {3.771429539657894*^9, 
   3.7714295405513687`*^9}, {3.771429618724918*^9, 3.771429623261997*^9}, {
   3.7714307899835873`*^9, 3.771430790436494*^9}, 3.771451104216363*^9, {
   3.771508095448917*^9, 3.771508110132432*^9}, {3.7715083225896187`*^9, 
   3.7715083306779222`*^9}, {3.771508374776663*^9, 3.771508386277514*^9}, {
   3.7715084270778646`*^9, 3.771508512389296*^9}, 3.771508543555127*^9, {
   3.77150858570796*^9, 3.771508618994934*^9}, {3.7715088207169943`*^9, 
   3.77150889031539*^9}, {3.771508923322143*^9, 3.771508923670087*^9}, 
   3.771508953753009*^9, 3.771509016175152*^9, 3.7715091247344227`*^9, {
   3.771509280836137*^9, 3.7715093899531307`*^9}, {3.771509422527775*^9, 
   3.771509422567185*^9}, {3.771509493986957*^9, 3.7715096052550087`*^9}, {
   3.771509653971591*^9, 3.771509693979186*^9}, {3.77150973259478*^9, 
   3.77150990173524*^9}, {3.771510004414825*^9, 3.771510008024968*^9}, 
   3.771510097994895*^9, 3.771510166795833*^9, 3.771510435525115*^9, {
   3.771510592878343*^9, 3.7715105957468767`*^9}, {3.7715107677541*^9, 
   3.771510769561739*^9}, {3.77151081284661*^9, 3.7715108155415583`*^9}, {
   3.7715108821134987`*^9, 3.7715109302915382`*^9}, {3.771510964009658*^9, 
   3.771510971129046*^9}, {3.771511010046406*^9, 3.7715110353755198`*^9}, {
   3.771511088136096*^9, 3.771511102886223*^9}, {3.7715114300949583`*^9, 
   3.771511430126233*^9}, {3.771511497625127*^9, 3.7715115693777018`*^9}, {
   3.771511643172413*^9, 3.771511646783353*^9}, {3.771511678993891*^9, 
   3.771511680277672*^9}, 3.7715127192809067`*^9, {3.771512800048661*^9, 
   3.7715128026246967`*^9}, {3.771512870902679*^9, 3.771512913650139*^9}, {
   3.7715133261672697`*^9, 3.7715133314839773`*^9}, 3.771513492252378*^9, {
   3.771514518198213*^9, 3.7715145227679043`*^9}, {3.77151708493652*^9, 
   3.771517087523554*^9}, {3.771517126782735*^9, 3.771517128810008*^9}, {
   3.771517210341956*^9, 3.7715172460665407`*^9}, {3.771517282285139*^9, 
   3.7715173175659246`*^9}, {3.771517350871862*^9, 3.771517380625053*^9}, {
   3.7715175364523573`*^9, 3.77151760571542*^9}, {3.771517640074253*^9, 
   3.7715176411021967`*^9}, {3.7715176899659986`*^9, 3.771517690090538*^9}, {
   3.7715177712211246`*^9, 3.771517772849249*^9}, 3.7715179959744*^9, {
   3.771518135783963*^9, 3.771518137899392*^9}, {3.7715184814367847`*^9, 
   3.771518486933831*^9}, {3.771518845518941*^9, 3.771518853375394*^9}, {
   3.771519841748459*^9, 3.771519843226256*^9}, {3.771520014828779*^9, 
   3.771520023308147*^9}, {3.771520059011042*^9, 3.7715201019782476`*^9}, {
   3.771520273028158*^9, 3.771520279593449*^9}, {3.771520883693551*^9, 
   3.7715208856464148`*^9}, {3.771520929250544*^9, 3.771520982269124*^9}, {
   3.771521188240921*^9, 3.771521191230611*^9}, {3.7715215916037903`*^9, 
   3.7715216236153183`*^9}, {3.7715219556354227`*^9, 
   3.7715219569119167`*^9}, {3.7715219940893173`*^9, 3.771522004818063*^9}, {
   3.771522127564417*^9, 3.771522133178886*^9}, {3.771522237696827*^9, 
   3.771522242483397*^9}, {3.771522476907035*^9, 3.7715224806870003`*^9}, {
   3.771612023511445*^9, 3.771612031753702*^9}, {3.771612079472707*^9, 
   3.7716120893051157`*^9}, {3.7716224793342648`*^9, 3.771622480136241*^9}, {
   3.771622883240336*^9, 3.7716228933155813`*^9}, {3.7716237449938374`*^9, 
   3.771623747126918*^9}, {3.771623796412709*^9, 3.771623799136798*^9}, {
   3.771624309956813*^9, 3.771624313155792*^9}, {3.7716243671319427`*^9, 
   3.771624385215858*^9}, {3.7716254457528887`*^9, 3.7716254552861023`*^9}, {
   3.77162627898118*^9, 3.771626290997555*^9}, {3.771626471915455*^9, 
   3.77162647431002*^9}, {3.771673175223734*^9, 3.771673224278071*^9}, {
   3.771673266441729*^9, 3.77167327762712*^9}, {3.771673352316105*^9, 
   3.771673358322695*^9}, {3.77167341370112*^9, 3.771673438464848*^9}, {
   3.77167350121453*^9, 3.771673525509131*^9}, {3.771673569348257*^9, 
   3.771673571015792*^9}, {3.771673621462082*^9, 3.771673654459712*^9}, {
   3.771673971590723*^9, 3.771673978668692*^9}, 3.7716741398792048`*^9, {
   3.7716743853006973`*^9, 3.7716744014626913`*^9}, 3.7716744754869757`*^9, {
   3.771674530543592*^9, 3.771674536953731*^9}, {3.771674606489312*^9, 
   3.771674718727125*^9}, {3.7716753405724497`*^9, 3.7716754333285303`*^9}, {
   3.771675677951398*^9, 3.771675732879408*^9}, {3.7716934952658777`*^9, 
   3.771693620671177*^9}, {3.771693675046061*^9, 3.771693728576635*^9}, {
   3.771693781310905*^9, 3.771693883952346*^9}, {3.771694119731741*^9, 
   3.771694149933621*^9}, {3.771694304010154*^9, 3.771694425887899*^9}, {
   3.771694474334434*^9, 3.771694494910709*^9}, {3.771694596704371*^9, 
   3.771694598251622*^9}, {3.7716948351254873`*^9, 3.771694920695097*^9}, {
   3.771694969267427*^9, 3.7716949698444967`*^9}, {3.771695031505924*^9, 
   3.771695113745822*^9}, 3.771695177835884*^9, {3.771695213958036*^9, 
   3.771695266066115*^9}, {3.7716954041134243`*^9, 3.771695410898822*^9}, {
   3.771695583126212*^9, 3.771695583229229*^9}, {3.77169977478448*^9, 
   3.771699791270179*^9}, {3.771699867500791*^9, 3.771699871576948*^9}, {
   3.7716999020934553`*^9, 3.771699906117627*^9}, {3.771699974950583*^9, 
   3.771699998868513*^9}, {3.771700029172598*^9, 3.771700059110957*^9}, {
   3.7717001316852818`*^9, 3.771700133480904*^9}, {3.7717001952221823`*^9, 
   3.771700217684945*^9}, {3.771700511884554*^9, 3.771700552476619*^9}, {
   3.771700592591902*^9, 3.771700596013958*^9}, {3.771700698821248*^9, 
   3.7717007012138844`*^9}, {3.771700772107574*^9, 3.771700809173306*^9}, {
   3.77170086753579*^9, 3.77170087085679*^9}, {3.7717009850100393`*^9, 
   3.771701009678179*^9}, {3.7717010664161863`*^9, 3.771701196333969*^9}, {
   3.771701254320465*^9, 3.771701280334656*^9}, {3.77170131268221*^9, 
   3.771701327175708*^9}, {3.7717014657292233`*^9, 3.771701474742733*^9}, {
   3.77170154752151*^9, 3.771701620553605*^9}, {3.771701662420892*^9, 
   3.771701666119358*^9}, {3.771701715617041*^9, 3.771701749865892*^9}, {
   3.771701807376012*^9, 3.7717019223061943`*^9}, {3.771701966969564*^9, 
   3.771701980769197*^9}, {3.771702186095017*^9, 3.771702248928144*^9}, {
   3.771702825562228*^9, 3.771702903638236*^9}, {3.77170297868432*^9, 
   3.771703006267295*^9}, {3.77170332595191*^9, 3.771703351048498*^9}, 
   3.771703613336029*^9, {3.771703648586445*^9, 3.771703667688582*^9}, {
   3.7717037613927603`*^9, 3.771703763946455*^9}, {3.771703934107439*^9, 
   3.771703970399081*^9}, {3.771704119521832*^9, 3.771704151626587*^9}, {
   3.771704195880794*^9, 3.7717041970978518`*^9}, {3.77170455487595*^9, 
   3.771704596558196*^9}, 3.7717047518764133`*^9, {3.7717048365757103`*^9, 
   3.771704861086286*^9}, {3.771704923946967*^9, 3.771704924378716*^9}, 
   3.771704958834386*^9, {3.7717052012613983`*^9, 3.771705202921657*^9}, {
   3.771705240706903*^9, 3.771705291514925*^9}, {3.771705351887005*^9, 
   3.771705367591695*^9}, {3.7717054514478073`*^9, 3.771705464332407*^9}, {
   3.771705497687747*^9, 3.771705506523614*^9}, {3.7717081154580173`*^9, 
   3.771708127804226*^9}, {3.771709391190151*^9, 3.771709392741667*^9}, {
   3.771709499221224*^9, 3.7717095408582783`*^9}, {3.77170957137186*^9, 
   3.771709580184259*^9}, 3.771709635126422*^9, {3.771709706659088*^9, 
   3.7717097100094347`*^9}, {3.771712044671608*^9, 3.7717120455787354`*^9}, 
   3.771712139459732*^9, {3.771712358500682*^9, 3.7717123756141768`*^9}, {
   3.771712436664987*^9, 3.771712509584537*^9}, {3.771712637639783*^9, 
   3.771712648272489*^9}, {3.771712855559021*^9, 3.7717130514849358`*^9}, {
   3.771713084425671*^9, 3.7717131090809507`*^9}, {3.771713141844676*^9, 
   3.771713141969996*^9}, {3.7717132111494617`*^9, 3.7717132253991823`*^9}, {
   3.7717132768409567`*^9, 3.771713278696121*^9}, {3.771713312163457*^9, 
   3.771713313456105*^9}, {3.771713344789674*^9, 3.771713445916922*^9}, {
   3.771714152460678*^9, 3.77171427170189*^9}, {3.771714446749147*^9, 
   3.77171446965423*^9}, 3.771715082386012*^9, 3.7717154473600492`*^9, {
   3.771768861292097*^9, 3.7717689354542913`*^9}, {3.77176955694038*^9, 
   3.771769612806575*^9}, 3.771771072817876*^9, {3.863519530904529*^9, 
   3.8635196461997833`*^9}, {3.863520055616123*^9, 3.863520055826187*^9}, {
   3.863702235350348*^9, 3.863702406011096*^9}, {3.86370311793416*^9, 
   3.8637031209173107`*^9}, {3.863703212782783*^9, 3.863703263781419*^9}, {
   3.8637033168690577`*^9, 3.863703428378481*^9}, {3.863703570815503*^9, 
   3.863703572273731*^9}, {3.863703780348802*^9, 3.863703830290897*^9}, {
   3.8637039227019176`*^9, 3.8637039309192142`*^9}, {3.863703963802443*^9, 
   3.863703968065487*^9}, {3.863704268424223*^9, 3.863704269181264*^9}, {
   3.863704299695795*^9, 3.863704309970429*^9}, {3.863787367823*^9, 
   3.863787371777608*^9}, {3.86378747845926*^9, 3.863787487164853*^9}, {
   3.8637875498670273`*^9, 3.86378762243974*^9}, {3.863787670167459*^9, 
   3.863787695132062*^9}, {3.863787766655367*^9, 
   3.863787769154354*^9}},ExpressionUUID->"5fb13b81-7d4f-4919-9146-\
b9d82449e1fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"make", " ", "map", " ", "suitable", " ", "for", " ", "graphing"}],
    " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"connections", "[", 
     RowBox[{
     "ruleSpec_", ",", " ", "init_", ",", " ", "size_", ",", " ", "nBlocks_", 
      ",", " ", "distance_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ruleReplace", "[", 
        RowBox[{"ruleSpec", ",", " ", 
         RowBox[{"blockOrder", "[", 
          RowBox[{
          "ruleSpec", ",", " ", "init", ",", " ", "size", ",", " ", "nBlocks",
            ",", " ", "distance"}], "]"}]}], "]"}], " ", "//.", "\n", "\t\t", 
       
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"a_", ",", " ", 
          RowBox[{"{", "b__Rule", "}"}]}], "]"}], " ", ":>", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{"a", ",", "#"}], "]"}], "&"}], " ", "/@", " ", 
           RowBox[{"Keys", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], ",", " ", "b"}], "}"}]}]}], " ",
       "//", "\n", "\t\t\t", "Flatten"}], " ", "//", " ", 
     "DeleteDuplicates"}]}], "\n", "\t\t\t\t", "\n", 
   RowBox[{"(*", " ", "visualization", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"showRuleConnections", "[", 
     RowBox[{
     "ruleSpec_", ",", " ", "init_", ",", " ", "size_", ",", " ", "nBlocks_", 
      ",", " ", "distance_"}], "]"}], " ", ":=", "\n", "\t", 
    RowBox[{"Graph", "[", 
     RowBox[{
      RowBox[{"connections", "[", 
       RowBox[{
       "ruleSpec", ",", " ", "init", ",", " ", "size", ",", " ", "nBlocks", 
        ",", " ", "distance"}], "]"}], ",", "\n", "\t\t", 
      RowBox[{"VertexShapeFunction", " ", "\[RuleDelayed]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Inset", "[", 
          RowBox[{
           RowBox[{"ArrayPlot", "[", 
            RowBox[{
             RowBox[{"CellularAutomaton", "[", 
              RowBox[{"#2", ",", " ", "init", ",", " ", 
               RowBox[{"size", "-", "1"}]}], "]"}], ",", " ", 
             RowBox[{"ImageSize", "->", 
              RowBox[{"{", 
               RowBox[{"100", ",", "100"}], "}"}]}]}], "]"}], ",", " ", "#1", 
           ",", " ", "Center", ",", " ", ".6"}], "]"}], "&"}], ")"}]}], ",", 
      "\n", "\t\t\t", 
      RowBox[{"ImagePadding", "\[Rule]", "25"}], ",", " ", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", " ", 
      RowBox[{"ImageSize", "\[Rule]", "800"}]}], "\n", "\t", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.770482787643997*^9, 3.770482921097328*^9}, {
   3.770482959794046*^9, 3.770483062443226*^9}, {3.770483139105879*^9, 
   3.770483142791513*^9}, {3.7704833713411627`*^9, 3.770483604393207*^9}, {
   3.770483652477036*^9, 3.770483668514173*^9}, {3.7704837314588003`*^9, 
   3.770483760241007*^9}, {3.77048379348855*^9, 3.770483818784292*^9}, {
   3.770483886037365*^9, 3.77048391704599*^9}, {3.770483982730173*^9, 
   3.770484041007475*^9}, {3.77048412028379*^9, 3.7704841228226023`*^9}, {
   3.770484218139017*^9, 3.770484239373794*^9}, {3.7704842830675592`*^9, 
   3.770484335072513*^9}, {3.770484689868153*^9, 3.770484707338176*^9}, {
   3.7704858240605583`*^9, 3.77048583343545*^9}, {3.77048590141014*^9, 
   3.770485901723312*^9}, {3.770486365317235*^9, 3.7704863665313587`*^9}, 
   3.770494386502613*^9, {3.770494470707664*^9, 3.770494645630993*^9}, {
   3.770494689386427*^9, 3.770494765588149*^9}, {3.7704948516503*^9, 
   3.770494888375936*^9}, {3.770494921269123*^9, 3.770495029608489*^9}, {
   3.7704950624466133`*^9, 3.770495141583098*^9}, {3.77049519230225*^9, 
   3.7704952643574133`*^9}, {3.770495449922097*^9, 3.7704955008340197`*^9}, {
   3.770495564766152*^9, 3.770495578779191*^9}, {3.770495620880939*^9, 
   3.770495654324613*^9}, 3.770546148986672*^9, 3.7705464136378736`*^9, {
   3.7705464597370453`*^9, 3.770546469723206*^9}, {3.770546510288927*^9, 
   3.770546531072365*^9}, {3.7705499059866543`*^9, 3.7705499209635277`*^9}, {
   3.770646995775899*^9, 3.770647162029993*^9}, {3.770647226016552*^9, 
   3.7706472960607977`*^9}, {3.770647344322225*^9, 3.770647427912814*^9}, {
   3.7706474763262453`*^9, 3.7706475285312357`*^9}, {3.770647579226934*^9, 
   3.7706475825076523`*^9}, {3.770647635720187*^9, 3.770647641473075*^9}, {
   3.770647712413559*^9, 3.77064771712294*^9}, {3.770647863127544*^9, 
   3.770647865474045*^9}, {3.770648147609572*^9, 3.7706481483061523`*^9}, {
   3.770648194531769*^9, 3.77064819764957*^9}, {3.7706482295255404`*^9, 
   3.770648251796324*^9}, {3.770648285676703*^9, 3.770648287071795*^9}, {
   3.7706483844894037`*^9, 3.770648408310869*^9}, {3.770648474457296*^9, 
   3.77064849181185*^9}, {3.77064919951954*^9, 3.770649219260521*^9}, {
   3.771012572080574*^9, 3.771012574557795*^9}, {3.7710130892382*^9, 
   3.7710131278577003`*^9}, {3.771013164671421*^9, 3.771013170662612*^9}, {
   3.771013241398697*^9, 3.771013293093876*^9}, {3.771013376828169*^9, 
   3.771013408917551*^9}, {3.771066027911306*^9, 3.7710660563644667`*^9}, {
   3.771066088967906*^9, 3.771066126393922*^9}, {3.771066304209084*^9, 
   3.771066417760647*^9}, {3.7710665061651993`*^9, 3.77106651827633*^9}, {
   3.7710665958461657`*^9, 3.771066599592246*^9}, {3.771066787106886*^9, 
   3.77106688118673*^9}, {3.771066917958227*^9, 3.771066920163258*^9}, {
   3.771066961041355*^9, 3.7710669697386007`*^9}, {3.771067019870351*^9, 
   3.771067054186266*^9}, {3.771067596745988*^9, 3.771067608539199*^9}, {
   3.7710677999321203`*^9, 3.771067828462199*^9}, {3.7710691448181763`*^9, 
   3.771069146191324*^9}, {3.771069401140826*^9, 3.7710694192296677`*^9}, {
   3.7710694544712057`*^9, 3.77106946175102*^9}, {3.771069510407185*^9, 
   3.771069546377035*^9}, {3.771069588713119*^9, 3.771069623729661*^9}, {
   3.7710777912034283`*^9, 3.771077797514872*^9}, {3.771077857747775*^9, 
   3.771077896683793*^9}, {3.7710779846984587`*^9, 3.7710780571582336`*^9}, {
   3.7710780916296473`*^9, 3.771078093185443*^9}, {3.771078157306479*^9, 
   3.7710783469069242`*^9}, {3.771078546205811*^9, 3.771078555275388*^9}, 
   3.771078785346652*^9, {3.771079086436943*^9, 3.771079086531608*^9}, {
   3.7710792132061577`*^9, 3.771079264419251*^9}, {3.7710796746024218`*^9, 
   3.77107985049893*^9}, {3.771079980556774*^9, 3.77108000254884*^9}, {
   3.771080037566615*^9, 3.771080126810281*^9}, {3.7710801647208*^9, 
   3.7710801660741787`*^9}, {3.771080197507674*^9, 3.7710802250598183`*^9}, {
   3.771080267960541*^9, 3.771080359083398*^9}, {3.771080406249712*^9, 
   3.771080421234771*^9}, {3.7710804782287493`*^9, 3.771080592180871*^9}, {
   3.7710806420884533`*^9, 3.771080643782098*^9}, {3.771080707357484*^9, 
   3.7710807526840153`*^9}, {3.771080786460499*^9, 3.7710807865927343`*^9}, {
   3.771080854778215*^9, 3.77108095974751*^9}, {3.7710810202456903`*^9, 
   3.771081023112467*^9}, {3.771081074111945*^9, 3.7710810835969048`*^9}, {
   3.7710813979098043`*^9, 3.771081432278171*^9}, {3.771081466981485*^9, 
   3.7710814671031923`*^9}, {3.771081505139979*^9, 3.771081583240635*^9}, {
   3.771081685649589*^9, 3.771081701105802*^9}, {3.771081759414233*^9, 
   3.771081781046382*^9}, {3.771081920400188*^9, 3.771081923433948*^9}, {
   3.771102715133277*^9, 3.7711027957900267`*^9}, {3.771102842399693*^9, 
   3.771102881808381*^9}, {3.771102929227768*^9, 3.7711029691401367`*^9}, {
   3.771103073447472*^9, 3.771103086180725*^9}, {3.7711031176933737`*^9, 
   3.771103123767542*^9}, {3.7711031660546627`*^9, 3.7711031834026413`*^9}, {
   3.7711032291580553`*^9, 3.7711034631767817`*^9}, {3.771103551409133*^9, 
   3.7711035565488443`*^9}, {3.771103589768116*^9, 3.771103643377743*^9}, {
   3.771104123721092*^9, 3.7711041535912523`*^9}, 3.7711042972171087`*^9, {
   3.771104442098654*^9, 3.7711044613789263`*^9}, {3.77110469507471*^9, 
   3.771104742941822*^9}, {3.771104774170217*^9, 3.77110482732683*^9}, {
   3.771155075730083*^9, 3.77115510319302*^9}, {3.7711552204793873`*^9, 
   3.771155256265522*^9}, {3.771155315803068*^9, 3.771155317177318*^9}, {
   3.771155352667796*^9, 3.7711554504442596`*^9}, {3.771155487442925*^9, 
   3.771155490673388*^9}, {3.771155532866001*^9, 3.7711555903371677`*^9}, {
   3.771155628649703*^9, 3.771155834814893*^9}, {3.7711558698054256`*^9, 
   3.7711559269158163`*^9}, 3.7711559705399923`*^9, {3.771156007382532*^9, 
   3.771156011094149*^9}, {3.771156048765955*^9, 3.771156049264926*^9}, {
   3.771156096767069*^9, 3.771156096825408*^9}, {3.7711561514908113`*^9, 
   3.77115623471835*^9}, {3.771156280227399*^9, 3.771156289782609*^9}, {
   3.771156373415247*^9, 3.7711563734818172`*^9}, {3.771156419112504*^9, 
   3.771156440871361*^9}, {3.771156495007992*^9, 3.7711565545108624`*^9}, {
   3.771156592609713*^9, 3.7711565927161903`*^9}, {3.771156768188053*^9, 
   3.771156795051096*^9}, 3.771156999731532*^9, {3.771157045274468*^9, 
   3.771157045541771*^9}, {3.771157114755713*^9, 3.771157137928946*^9}, 
   3.7711600338876333`*^9, {3.771242096819364*^9, 3.771242126195787*^9}, {
   3.771242256031309*^9, 3.771242258590022*^9}, {3.771242409531823*^9, 
   3.771242427172946*^9}, {3.771242887847391*^9, 3.7712430086268187`*^9}, 
   3.7712430584239273`*^9, {3.771243106934415*^9, 3.771243107568427*^9}, {
   3.7712431714277573`*^9, 3.771243197952642*^9}, {3.771244552432255*^9, 
   3.771244577042035*^9}, {3.77142514036493*^9, 3.771425142502884*^9}, {
   3.7714251943895397`*^9, 3.771425215829914*^9}, {3.77142527264194*^9, 
   3.7714253037709*^9}, {3.771425370795764*^9, 3.771425408257433*^9}, {
   3.771425440099287*^9, 3.7714254402688704`*^9}, {3.771425473750928*^9, 
   3.7714255960830173`*^9}, {3.771425631818544*^9, 3.771425675253339*^9}, {
   3.771425719721884*^9, 3.771425740883687*^9}, {3.77142580515589*^9, 
   3.7714258447466307`*^9}, {3.771425981145659*^9, 3.771426077771694*^9}, {
   3.771426125827806*^9, 3.771426127166316*^9}, {3.7714261869034653`*^9, 
   3.77142620723772*^9}, {3.7714262758003807`*^9, 3.77142627714293*^9}, {
   3.771426320226757*^9, 3.771426324649633*^9}, {3.771426394553677*^9, 
   3.771426422846036*^9}, {3.7714264814633904`*^9, 3.771426484560677*^9}, {
   3.7714265255888844`*^9, 3.77142656450191*^9}, {3.77142666832382*^9, 
   3.771426701226253*^9}, {3.7714267992888727`*^9, 3.771426802098439*^9}, {
   3.771426837696424*^9, 3.77142684252494*^9}, {3.771426881502282*^9, 
   3.77142689463704*^9}, {3.771426944474209*^9, 3.771426954837367*^9}, {
   3.771427085611624*^9, 3.771427208321937*^9}, {3.77142725982743*^9, 
   3.771427342676564*^9}, {3.771427387096983*^9, 3.77142741387674*^9}, {
   3.7714274823067417`*^9, 3.771427620083233*^9}, {3.771427650958089*^9, 
   3.771427735642126*^9}, {3.771427811732935*^9, 3.7714278281384907`*^9}, {
   3.771427984750801*^9, 3.771428010767819*^9}, {3.771428145789899*^9, 
   3.771428219232523*^9}, {3.77142845337399*^9, 3.771428832443232*^9}, {
   3.77142919635216*^9, 3.7714292167538853`*^9}, {3.771429255809939*^9, 
   3.771429255862849*^9}, {3.771429324211997*^9, 3.771429324566071*^9}, {
   3.771429398212832*^9, 3.771429402512352*^9}, {3.771429442429163*^9, 
   3.7714294540990467`*^9}, 3.7714294941500063`*^9, {3.771429539657894*^9, 
   3.7714295405513687`*^9}, {3.771429618724918*^9, 3.771429623261997*^9}, {
   3.7714307899835873`*^9, 3.771430790436494*^9}, 3.771451104216363*^9, {
   3.771508095448917*^9, 3.771508110132432*^9}, {3.7715083225896187`*^9, 
   3.7715083306779222`*^9}, {3.771508374776663*^9, 3.771508386277514*^9}, {
   3.7715084270778646`*^9, 3.771508512389296*^9}, 3.771508543555127*^9, {
   3.77150858570796*^9, 3.771508618994934*^9}, {3.7715088207169943`*^9, 
   3.77150889031539*^9}, {3.771508923322143*^9, 3.771508923670087*^9}, 
   3.771508953753009*^9, 3.771509016175152*^9, 3.7715091247344227`*^9, {
   3.771509280836137*^9, 3.7715093899531307`*^9}, {3.771509422527775*^9, 
   3.771509422567185*^9}, {3.771509493986957*^9, 3.7715096052550087`*^9}, {
   3.771509653971591*^9, 3.771509693979186*^9}, {3.77150973259478*^9, 
   3.77150990173524*^9}, {3.771510004414825*^9, 3.771510008024968*^9}, 
   3.771510097994895*^9, 3.771510166795833*^9, 3.771510435525115*^9, {
   3.771510592878343*^9, 3.7715105957468767`*^9}, {3.7715107677541*^9, 
   3.771510769561739*^9}, {3.77151081284661*^9, 3.7715108155415583`*^9}, {
   3.7715108821134987`*^9, 3.7715109302915382`*^9}, {3.771510964009658*^9, 
   3.771510971129046*^9}, {3.771511010046406*^9, 3.7715110353755198`*^9}, {
   3.771511088136096*^9, 3.771511102886223*^9}, {3.7715114300949583`*^9, 
   3.771511430126233*^9}, {3.771511497625127*^9, 3.7715115693777018`*^9}, {
   3.771511643172413*^9, 3.771511646783353*^9}, {3.771511678993891*^9, 
   3.771511680277672*^9}, 3.7715127192809067`*^9, {3.771512800048661*^9, 
   3.7715128026246967`*^9}, {3.771512870902679*^9, 3.771512913650139*^9}, {
   3.7715133261672697`*^9, 3.7715133314839773`*^9}, 3.771513492252378*^9, {
   3.771514518198213*^9, 3.7715145227679043`*^9}, {3.77151708493652*^9, 
   3.771517087523554*^9}, {3.771517126782735*^9, 3.771517128810008*^9}, {
   3.771517210341956*^9, 3.7715172460665407`*^9}, {3.771517282285139*^9, 
   3.7715173175659246`*^9}, {3.771517350871862*^9, 3.771517380625053*^9}, {
   3.7715175364523573`*^9, 3.77151760571542*^9}, {3.771517640074253*^9, 
   3.7715176411021967`*^9}, {3.7715176899659986`*^9, 3.771517690090538*^9}, {
   3.7715177712211246`*^9, 3.771517772849249*^9}, 3.7715179959744*^9, {
   3.771518135783963*^9, 3.771518137899392*^9}, {3.7715184814367847`*^9, 
   3.771518486933831*^9}, {3.771518845518941*^9, 3.771518853375394*^9}, {
   3.771519841748459*^9, 3.771519843226256*^9}, {3.771520014828779*^9, 
   3.771520023308147*^9}, {3.771520059011042*^9, 3.7715201019782476`*^9}, {
   3.771520273028158*^9, 3.771520279593449*^9}, {3.771520883693551*^9, 
   3.7715208856464148`*^9}, {3.771520929250544*^9, 3.771520982269124*^9}, {
   3.771521188240921*^9, 3.771521191230611*^9}, {3.7715215916037903`*^9, 
   3.7715216236153183`*^9}, {3.7715219556354227`*^9, 
   3.7715219569119167`*^9}, {3.7715219940893173`*^9, 3.771522004818063*^9}, {
   3.771522127564417*^9, 3.771522133178886*^9}, {3.771522237696827*^9, 
   3.771522242483397*^9}, {3.771522476907035*^9, 3.7715224806870003`*^9}, {
   3.771612023511445*^9, 3.771612031753702*^9}, {3.771612079472707*^9, 
   3.7716120893051157`*^9}, {3.7716224793342648`*^9, 3.771622480136241*^9}, {
   3.771622883240336*^9, 3.7716228933155813`*^9}, {3.7716237449938374`*^9, 
   3.771623747126918*^9}, {3.771623796412709*^9, 3.771623799136798*^9}, {
   3.771624309956813*^9, 3.771624313155792*^9}, {3.7716243671319427`*^9, 
   3.771624385215858*^9}, {3.7716254457528887`*^9, 3.7716254552861023`*^9}, {
   3.77162627898118*^9, 3.771626290997555*^9}, {3.771626471915455*^9, 
   3.77162647431002*^9}, {3.771673175223734*^9, 3.771673224278071*^9}, {
   3.771673266441729*^9, 3.77167327762712*^9}, {3.771673352316105*^9, 
   3.771673358322695*^9}, {3.77167341370112*^9, 3.771673438464848*^9}, {
   3.77167350121453*^9, 3.771673525509131*^9}, {3.771673569348257*^9, 
   3.771673571015792*^9}, {3.771673621462082*^9, 3.771673654459712*^9}, {
   3.771673971590723*^9, 3.771673978668692*^9}, 3.7716741398792048`*^9, {
   3.7716743853006973`*^9, 3.7716744014626913`*^9}, 3.7716744754869757`*^9, {
   3.771674530543592*^9, 3.771674536953731*^9}, {3.771674606489312*^9, 
   3.771674718727125*^9}, {3.7716753405724497`*^9, 3.7716754333285303`*^9}, {
   3.771675677951398*^9, 3.771675732879408*^9}, {3.7716934952658777`*^9, 
   3.771693620671177*^9}, {3.771693675046061*^9, 3.771693728576635*^9}, {
   3.771693781310905*^9, 3.771693883952346*^9}, {3.771694119731741*^9, 
   3.771694149933621*^9}, {3.771694304010154*^9, 3.771694425887899*^9}, {
   3.771694474334434*^9, 3.771694494910709*^9}, {3.771694596704371*^9, 
   3.771694598251622*^9}, {3.7716948351254873`*^9, 3.771694920695097*^9}, {
   3.771694969267427*^9, 3.7716949698444967`*^9}, {3.771695031505924*^9, 
   3.771695113745822*^9}, 3.771695177835884*^9, {3.771695213958036*^9, 
   3.771695266066115*^9}, {3.7716954041134243`*^9, 3.771695410898822*^9}, {
   3.771695583126212*^9, 3.771695583229229*^9}, {3.77169977478448*^9, 
   3.771699791270179*^9}, {3.771699867500791*^9, 3.771699871576948*^9}, {
   3.7716999020934553`*^9, 3.771699906117627*^9}, {3.771699974950583*^9, 
   3.771699998868513*^9}, {3.771700029172598*^9, 3.771700059110957*^9}, {
   3.7717001316852818`*^9, 3.771700133480904*^9}, {3.7717001952221823`*^9, 
   3.771700217684945*^9}, {3.771700511884554*^9, 3.771700552476619*^9}, {
   3.771700592591902*^9, 3.771700596013958*^9}, {3.771700698821248*^9, 
   3.7717007012138844`*^9}, {3.771700772107574*^9, 3.771700809173306*^9}, {
   3.77170086753579*^9, 3.77170087085679*^9}, {3.7717009850100393`*^9, 
   3.771701009678179*^9}, {3.7717010664161863`*^9, 3.771701196333969*^9}, {
   3.771701254320465*^9, 3.771701280334656*^9}, {3.77170131268221*^9, 
   3.771701327175708*^9}, {3.7717014657292233`*^9, 3.771701474742733*^9}, {
   3.77170154752151*^9, 3.771701620553605*^9}, {3.771701662420892*^9, 
   3.771701666119358*^9}, {3.771701715617041*^9, 3.771701749865892*^9}, {
   3.771701807376012*^9, 3.7717019223061943`*^9}, {3.771701966969564*^9, 
   3.771701980769197*^9}, {3.771702186095017*^9, 3.771702248928144*^9}, {
   3.771702825562228*^9, 3.771702903638236*^9}, {3.77170297868432*^9, 
   3.771703006267295*^9}, {3.77170332595191*^9, 3.771703351048498*^9}, 
   3.771703613336029*^9, {3.771703648586445*^9, 3.771703667688582*^9}, {
   3.7717037613927603`*^9, 3.771703763946455*^9}, {3.771703934107439*^9, 
   3.771703970399081*^9}, {3.771704119521832*^9, 3.771704151626587*^9}, {
   3.771704195880794*^9, 3.7717041970978518`*^9}, {3.77170455487595*^9, 
   3.771704596558196*^9}, 3.7717047518764133`*^9, {3.7717048365757103`*^9, 
   3.771704861086286*^9}, {3.771704923946967*^9, 3.771704924378716*^9}, 
   3.771704958834386*^9, {3.7717052012613983`*^9, 3.771705202921657*^9}, {
   3.771705240706903*^9, 3.771705291514925*^9}, {3.771705351887005*^9, 
   3.771705367591695*^9}, {3.7717054514478073`*^9, 3.771705464332407*^9}, {
   3.771705497687747*^9, 3.771705506523614*^9}, {3.7717081154580173`*^9, 
   3.771708127804226*^9}, {3.771709391190151*^9, 3.771709392741667*^9}, {
   3.771709499221224*^9, 3.7717095408582783`*^9}, {3.77170957137186*^9, 
   3.771709580184259*^9}, 3.771709635126422*^9, {3.771709706659088*^9, 
   3.7717097100094347`*^9}, {3.771712044671608*^9, 3.7717120455787354`*^9}, 
   3.771712139459732*^9, {3.771712358500682*^9, 3.7717123756141768`*^9}, {
   3.771712436664987*^9, 3.771712509584537*^9}, {3.771712637639783*^9, 
   3.771712648272489*^9}, {3.771712855559021*^9, 3.7717130514849358`*^9}, {
   3.771713084425671*^9, 3.7717131090809507`*^9}, {3.771713141844676*^9, 
   3.771713141969996*^9}, {3.7717132111494617`*^9, 3.7717132253991823`*^9}, {
   3.7717132768409567`*^9, 3.771713278696121*^9}, {3.771713312163457*^9, 
   3.771713313456105*^9}, {3.771713344789674*^9, 3.771713445916922*^9}, {
   3.771714152460678*^9, 3.77171427170189*^9}, {3.771714446749147*^9, 
   3.77171446965423*^9}, 3.771715082386012*^9, 3.7717154473600492`*^9, {
   3.771768861292097*^9, 3.7717689354542913`*^9}, {3.77176955694038*^9, 
   3.771769612806575*^9}, 3.771771072817876*^9, {3.863519530904529*^9, 
   3.8635196461997833`*^9}, {3.863520055616123*^9, 3.863520055826187*^9}, {
   3.863702235350348*^9, 3.863702406011096*^9}, {3.86370311793416*^9, 
   3.8637031209173107`*^9}, {3.863703212782783*^9, 3.863703263781419*^9}, {
   3.8637033168690577`*^9, 3.863703428378481*^9}, {3.863703570815503*^9, 
   3.863703572273731*^9}, {3.863703780348802*^9, 3.863703830290897*^9}, {
   3.8637039227019176`*^9, 3.8637039309192142`*^9}, {3.863703963802443*^9, 
   3.863703968065487*^9}, {3.863704268424223*^9, 3.863704269181264*^9}, {
   3.863704299695795*^9, 3.863704309970429*^9}, {3.863787367823*^9, 
   3.863787371777608*^9}, {3.86378747845926*^9, 3.863787487164853*^9}, {
   3.8637875498670273`*^9, 3.86378762243974*^9}, {3.863787670167459*^9, 
   3.863787695132062*^9}, {3.863787766655367*^9, 3.863787839336514*^9}, {
   3.863787964085387*^9, 3.863787989165079*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"0201e35e-88b4-4276-ae72-ec4fcb05987a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[" Testing", "Section",
 CellChangeTimes->{{3.863520977712336*^9, 
  3.86352097978231*^9}},ExpressionUUID->"7f292310-35e5-45b2-9e92-\
d79c88665d9f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"k", " ", "=", " ", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", " ", "=", " ", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.863703652756852*^9, 3.863703660903553*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"5dfa62a7-5dc2-4faf-a87f-26dd051fd5eb"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"n", " ", "=", " ", 
  RowBox[{"getRule", "[", 
   RowBox[{"k", ",", " ", "r"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.863703662713257*^9, 3.863703664871295*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"852c7602-fc85-44e9-b737-0d5fe80201d9"],

Cell[BoxData["213"], "Output",
 CellChangeTimes->{3.863703665277677*^9, 3.863787434526471*^9},
 CellLabel->"Out[15]=",ExpressionUUID->"198b95d7-18be-43a7-a882-0de0a9f49d8b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"size", "=", "50"}], ";"}]], "Input",
 CellChangeTimes->{{3.863787444594059*^9, 3.8637874460646467`*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"15e2fce2-4111-48b8-811d-50f7bbb613cc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blocks", " ", "=", " ", 
  RowBox[{"getBlocks", "[", 
   RowBox[{"k", ",", " ", "r"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.863703671372342*^9, 3.863703674201589*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"551224bf-6817-4da6-8dfb-95ce6a2bf8b9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.863703674621389*^9, 3.863787435245246*^9},
 CellLabel->"Out[16]=",ExpressionUUID->"5a87b23e-53eb-4a77-adf1-c4e1148c1aaf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"digits", " ", "=", " ", 
  RowBox[{"ruleDigits", "[", 
   RowBox[{"n", ",", "k", ",", "r"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.863703679450053*^9, 3.863703688859844*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"42fe47a9-4526-4413-916a-5b35eced7820"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}],
   "}"}]], "Output",
 CellChangeTimes->{3.8637036892717657`*^9, 3.8637874359985857`*^9},
 CellLabel->"Out[17]=",ExpressionUUID->"6a795b4a-ea83-406f-8734-0f5609ca9179"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"init", " ", "=", " ", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{"1", ",", "50"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8637037036605873`*^9, 3.863703711620002*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"b1dbd5b7-84c3-4454-9dea-e4112083ba52"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"countUses", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
   "50"}], "]"}]], "Input",
 CellChangeTimes->{{3.8637037125502357`*^9, 3.863703723677775*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c65ba51c-6fac-4ecd-bc92-ab452cd06d35"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "63", ",", "178", ",", "18", ",", "173", ",", "175", ",", "15", ",", "173", 
   ",", "5"}], "}"}]], "Output",
 CellChangeTimes->{3.863703724187303*^9, 3.863787437418446*^9},
 CellLabel->"Out[19]=",ExpressionUUID->"fa1ebefa-4684-4dd2-b090-b6e5be47452f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blockOrder", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
   "size", ",", " ", "3", ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.8637037364023533`*^9, 3.86370377023713*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"addf4d46-4984-4f97-8a33-7f59aec2eb32"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "3", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.863703770669319*^9, 3.863703846210835*^9, {3.86378743822036*^9, 
   3.8637874486028757`*^9}},
 CellLabel->"Out[22]=",ExpressionUUID->"e54bbcdb-90c9-45dc-87f0-213dc2c18261"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"blockShifts", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "2"}], "]"}]], "Input",\

 CellChangeTimes->{{3.8637038822267838`*^9, 3.863703890041677*^9}, {
  3.863787508681149*^9, 3.8637875178528547`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"145e6ef0-6a9d-4b8f-b417-08ea758c5bf9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"149", ",", "2", ",", "1"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.863703893969552*^9, 3.863703939339678*^9, 3.8637039710440817`*^9, 
   3.863704208179583*^9, 3.863704339135788*^9, 3.863787449846336*^9, {
   3.863787510621511*^9, 3.8637875181233177`*^9}},
 CellLabel->"Out[34]=",ExpressionUUID->"3ee152ed-d40e-43c6-8455-8f652950169a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ruleReplace", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "}"}], ",", " ", 
   RowBox[{"blockOrder", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
     "size", ",", " ", "3", ",", " ", "1"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.863704344031939*^9, 3.8637043451894073`*^9}, {
  3.863704377146657*^9, 3.8637043885183268`*^9}, {3.863787563784425*^9, 
  3.86378756484866*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"f2ba3ca1-fdb5-43aa-bb5b-a557f89b9cac"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"213", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"209", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"241", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"113", ",", "2", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.863704389134163*^9, 3.8637873746293793`*^9, 
  3.863787450421258*^9, 3.863787519580492*^9, 3.863787565095418*^9},
 CellLabel->"Out[44]=",ExpressionUUID->"1ec0b1fe-a1b1-407a-b39c-debf9bf92ca8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"connections", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", " ", "k", ",", " ", "r"}], "}"}], ",", " ", "init", ",",
    " ", "size", ",", " ", "3", ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.8637873301954813`*^9, 3.8637873345991488`*^9}, {
  3.86378738312471*^9, 3.863787383920849*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8f71fb2f-a70f-46ab-bf7a-c302524b379e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"213", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"209", ",", "2", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"209", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"241", ",", "2", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"241", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"113", ",", "2", ",", "1"}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.863787335081871*^9, {3.863787375306608*^9, 3.8637873841815023`*^9}, 
   3.863787451012422*^9, 3.863787520083974*^9},
 CellLabel->"Out[36]=",ExpressionUUID->"3bb13311-981d-4119-a938-4c3c2669bcec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iterateRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
   "size", ",", " ", "3", ",", " ", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.863787626554022*^9, 3.863787632305806*^9}},
 CellLabel->"In[53]:=",ExpressionUUID->"f0d12818-0680-4260-b630-dd69e4840def"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"213", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"209", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"241", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"113", ",", "2", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.863787632732852*^9},
 CellLabel->"Out[53]=",ExpressionUUID->"28c0501b-55bc-4982-8284-21b723384100"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iterateRule", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
   "size", ",", " ", "3", ",", " ", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.863787638658964*^9, 3.863787638721107*^9}},
 CellLabel->"In[54]:=",ExpressionUUID->"2ba628a5-dd78-409f-aecd-ab44496df9f0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"213", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"245", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"117", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"101", ",", "2", ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.863787639116033*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"e420bda9-196e-4022-8b20-c977f9202762"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RulePlot", "[", 
  RowBox[{"CellularAutomaton", "[", 
   RowBox[{"{", 
    RowBox[{"209", ",", "2", ",", "1"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8637877137968493`*^9, 3.8637877503382463`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"78f954c2-735a-450a-8a46-38891cd021d7"],

Cell[BoxData[
 GraphicsBox[{{InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{0.6153846153846154, Rational[1, 2]}, {0.6153846153846154, 
      0.5}], {Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{1.8461538461538463`, Rational[1, 2]}, {1.8461538461538463`, 
      0.5}], {Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{3.076923076923077, Rational[1, 2]}, {3.076923076923077, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{4.307692307692308, Rational[1, 2]}, {4.307692307692308, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{5.538461538461538, Rational[1, 2]}, {5.538461538461538, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{6.76923076923077, Rational[1, 2]}, {6.76923076923077, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{8., Rational[1, 2]}, {8., 0.5}], {
     Center, Center}, {1.2307692307692317, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{9.230769230769232, Rational[1, 2]}, {9.230769230769232, 0.5}], {
     Center, Center}, {1.23076923076923, 1}]}, 
   {GrayLevel[
    0.8], {LineBox[{{0, 0}, {0, 1}}], 
     LineBox[{{1.2307692307692308`, 0}, {1.2307692307692308`, 1}}], 
     LineBox[{{2.4615384615384617`, 0}, {2.4615384615384617`, 1}}], 
     LineBox[{{3.6923076923076925`, 0}, {3.6923076923076925`, 1}}], 
     LineBox[{{4.923076923076923, 0}, {4.923076923076923, 1}}], 
     LineBox[{{6.153846153846154, 0}, {6.153846153846154, 1}}], 
     LineBox[{{7.384615384615385, 0}, {7.384615384615385, 1}}], 
     LineBox[{{8.615384615384617, 0}, {8.615384615384617, 1}}], 
     LineBox[{{9.846153846153847, 0}, {9.846153846153847, 1}}]}, {
     LineBox[{{0, 0}, {9.846153846153847, 0}}], 
     LineBox[{{0, 1}, {9.846153846153847, 1}}]}}}]], "Output",
 CellChangeTimes->{{3.863787722169628*^9, 3.863787750728662*^9}},
 CellLabel->"Out[57]=",ExpressionUUID->"ab48601f-08c9-41a3-a64f-80b36250562e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RulePlot", "[", 
  RowBox[{"CellularAutomaton", "[", 
   RowBox[{"{", 
    RowBox[{"241", ",", "2", ",", "1"}], "}"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8637877272517433`*^9, 3.863787752169175*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"c172e565-73c7-41bc-8cfb-169b4e155b98"],

Cell[BoxData[
 GraphicsBox[{{InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{0.6153846153846154, Rational[1, 2]}, {0.6153846153846154, 
      0.5}], {Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{1.8461538461538463`, Rational[1, 2]}, {1.8461538461538463`, 
      0.5}], {Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{3.076923076923077, Rational[1, 2]}, {3.076923076923077, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{4.307692307692308, Rational[1, 2]}, {4.307692307692308, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{5.538461538461538, Rational[1, 2]}, {5.538461538461538, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[0], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{6.76923076923077, Rational[1, 2]}, {6.76923076923077, 0.5}], {
     Center, Center}, {1.2307692307692308, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[0], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{8., Rational[1, 2]}, {8., 0.5}], {
     Center, Center}, {1.2307692307692317, 1}], InsetBox[
     GraphicsBox[{
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-3, 2], 0}, {-1.5, 0}]]}, 
        {GrayLevel[1], RectangleBox[NCache[{Rational[-1, 2], 0}, {-0.5, 0}]]}, 
        {GrayLevel[1], 
         RectangleBox[NCache[{Rational[1, 2], 0}, {0.5, 0}]]}}, 
       {EdgeForm[GrayLevel[
         NCache[-1 + GoldenRatio, 0.6180339887498949]]], 
        {GrayLevel[0], 
         RectangleBox[
          NCache[{Rational[-1, 2], Rational[-5, 4]}, {-0.5, -1.25}]]}}},
      PlotRange->NCache[{{-2, 2}, {
          Rational[-7, 4], 
          Rational[3, 2]}}, {{-2, 2}, {-1.75, 1.5}}]], 
     NCache[{9.230769230769232, Rational[1, 2]}, {9.230769230769232, 0.5}], {
     Center, Center}, {1.23076923076923, 1}]}, 
   {GrayLevel[
    0.8], {LineBox[{{0, 0}, {0, 1}}], 
     LineBox[{{1.2307692307692308`, 0}, {1.2307692307692308`, 1}}], 
     LineBox[{{2.4615384615384617`, 0}, {2.4615384615384617`, 1}}], 
     LineBox[{{3.6923076923076925`, 0}, {3.6923076923076925`, 1}}], 
     LineBox[{{4.923076923076923, 0}, {4.923076923076923, 1}}], 
     LineBox[{{6.153846153846154, 0}, {6.153846153846154, 1}}], 
     LineBox[{{7.384615384615385, 0}, {7.384615384615385, 1}}], 
     LineBox[{{8.615384615384617, 0}, {8.615384615384617, 1}}], 
     LineBox[{{9.846153846153847, 0}, {9.846153846153847, 1}}]}, {
     LineBox[{{0, 0}, {9.846153846153847, 0}}], 
     LineBox[{{0, 1}, {9.846153846153847, 1}}]}}}]], "Output",
 CellChangeTimes->{{3.863787728313594*^9, 3.863787752535544*^9}},
 CellLabel->"Out[58]=",ExpressionUUID->"bb4d0c1f-fed6-4073-bb36-c71b8f84ff1c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showRuleConnections", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
   "size", ",", " ", "3", ",", " ", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.863787820239312*^9, 3.863787822017803*^9}, {
  3.863787891830236*^9, 3.863787891908443*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"928e0dda-0495-4e2b-a2d1-28b9b85f7e9c"],

Cell[BoxData[
 GraphicsBox[
  NamespaceBox["NetworkGraphics",
   DynamicModuleBox[{Typeset`graph = HoldComplete[
     Graph[{{213, 2, 1}, {212, 2, 1}, {208, 2, 1}, {240, 2, 
      1}}, {{{1, 2}, {2, 3}, {3, 4}}, Null}, {
      ImagePadding -> 25, ImageSize -> 800, PlotRange -> All, 
       VertexShapeFunction -> {Inset[
          ArrayPlot[
           
           CellularAutomaton[#2, {1, 0, 1, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0,
             1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 1, 1, 0, 0,
             0, 1, 1, 0, 1, 0, 1, 0, 0, 1, 0, 0, 0}, 50 - 1], 
           ImageSize -> {100, 100}], #, Center, 0.6]& }}]]}, 
    TagBox[GraphicsGroupBox[{
       {Hue[0.6, 0.7, 0.5], Opacity[0.7], Arrowheads[Medium], 
        ArrowBox[{{{0., 6.123233995736766*^-16}, {1., 
         4.898587196589413*^-16}}, {{1., 4.898587196589413*^-16}, {2., 
         2.4492935982947064`*^-16}}, {{2., 2.4492935982947064`*^-16}, {3., 
         0.}}}, 0.030239520958083826`]}, 
       {Hue[0.6, 0.2, 0.8], EdgeForm[{GrayLevel[0], Opacity[0.7]}], InsetBox[
         GraphicsBox[RasterBox[CompressedData["
1:eJzdlMERwjAMBO/ohBYohRLSAP3/eMQxOlnGEQN6kBnnoXizZyvOdXvctwuA
WxsgdYwVN9IACgAWACgAWACgAGABgAKAfwL4I/ULYPw1fB/IxPoUOB+rb1MC
ADOxjn3KArslBRBpADwTyx26tWU4pSvLCCwspnWm50uADnhjMY2QWFOLzaTA
xKKZNFZoMQqZObWIQvJMLG7ZQTpnMQCchaHFAqBYGFoUoFoQWDwgluG7jACI
pVVeTyKA3dKm9PXs72oX9kq7HRY+AbTIBpE=
           "], {{0, 0}, {50, 50}}, {0, 
           1}],
          Frame->Automatic,
          FrameLabel->{None, None},
          FrameTicks->{{None, None}, {None, None}},
          GridLinesStyle->Directive[
            GrayLevel[0.5, 0.4]],
          ImageSize->{100, 100},
          
          Method->{
           "DefaultBoundaryStyle" -> Automatic, 
            "DefaultGraphicsInteraction" -> {
             "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
              "Effects" -> {
               "Highlight" -> {"ratio" -> 2}, 
                "HighlightPoint" -> {"ratio" -> 2}, 
                "Droplines" -> {
                 "freeformCursorMode" -> True, 
                  "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
            "DefaultPlotStyle" -> Automatic}], {0., 6.123233995736766*^-16}, 
         Center, 0.6], InsetBox[
         GraphicsBox[RasterBox[CompressedData["
1:eJzd1LERwyAQRNFdd+IWXIpLUAPqP3MgRtwenACPfIEDEo2e/zEYPbf9vT0A
vMoC6Vf7RNYyQALwY/0CIAEwASABMAEgATAB4E9A79NwN2g/DfeDlbG+AOXt
BUAsA3B+rLqLVQDOjSVXYqbi7tC44sGw0txSDirm6MyZDwHcWBcVcxACwoqd
SccKKjpTE4tA/S/BxyIArSCsnACuwqBiAKXCoGIBtYJuRQFsBd2KB1Ipe5NK
A+gqdT/Hb3UAzgo/ORMHSw==
           "], {{0, 0}, {50, 50}}, {0, 1}],
          Frame->Automatic,
          FrameLabel->{None, None},
          FrameTicks->{{None, None}, {None, None}},
          GridLinesStyle->Directive[
            GrayLevel[0.5, 0.4]],
          ImageSize->{100, 100},
          
          Method->{
           "DefaultBoundaryStyle" -> Automatic, 
            "DefaultGraphicsInteraction" -> {
             "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
              "Effects" -> {
               "Highlight" -> {"ratio" -> 2}, 
                "HighlightPoint" -> {"ratio" -> 2}, 
                "Droplines" -> {
                 "freeformCursorMode" -> True, 
                  "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
            "DefaultPlotStyle" -> Automatic}], {1., 4.898587196589413*^-16}, 
         Center, 0.6], InsetBox[
         GraphicsBox[RasterBox[CompressedData["
1:eJzt1rsNgDAMhOH/2IQVGIURsgD7d+DEokCicGOZR5STLJ++3nPb1jYBi0cW
2T+iPvnrxVjjDec+AlQSkAAUBiQAJQA+CxQG/ODhQCUBJYESACWBwoCXAIUB
CUBhQAa4nGTcAEZj8w6Ixgjf
           "], {{0, 0}, {50, 50}}, {0, 1}],
          Frame->Automatic,
          FrameLabel->{None, None},
          FrameTicks->{{None, None}, {None, None}},
          GridLinesStyle->Directive[
            GrayLevel[0.5, 0.4]],
          ImageSize->{100, 100},
          
          Method->{
           "DefaultBoundaryStyle" -> Automatic, 
            "DefaultGraphicsInteraction" -> {
             "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
              "Effects" -> {
               "Highlight" -> {"ratio" -> 2}, 
                "HighlightPoint" -> {"ratio" -> 2}, 
                "Droplines" -> {
                 "freeformCursorMode" -> True, 
                  "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
            "DefaultPlotStyle" -> Automatic}], {2., 2.4492935982947064*^-16}, 
         Center, 0.6], InsetBox[
         GraphicsBox[RasterBox[CompressedData["
1:eJzty8ENgDAMBMFdOqEFSqEEGqD/H4TQwH0sIxH5bCvWrMe5HwuwvXHEUXfu
Ofp8zJ+3PZe5p8CWgAJgDCgAFgBaAmNADIwBP/g4sCWgJbAA0BJYAIiBMSAG
xoACYAxoCbwAt/8IGw==
           "], {{0, 0}, {50, 50}}, {0, 1}],
          Frame->Automatic,
          FrameLabel->{None, None},
          FrameTicks->{{None, None}, {None, None}},
          GridLinesStyle->Directive[
            GrayLevel[0.5, 0.4]],
          ImageSize->{100, 100},
          
          Method->{
           "DefaultBoundaryStyle" -> Automatic, 
            "DefaultGraphicsInteraction" -> {
             "Version" -> 1.2, "TrackMousePosition" -> {True, False}, 
              "Effects" -> {
               "Highlight" -> {"ratio" -> 2}, 
                "HighlightPoint" -> {"ratio" -> 2}, 
                "Droplines" -> {
                 "freeformCursorMode" -> True, 
                  "placement" -> {"x" -> "All", "y" -> "None"}}}}, 
            "DefaultPlotStyle" -> Automatic}], {3., 0.}, Center, 0.6]}}],
     MouseAppearanceTag["NetworkGraphics"]],
    AllowKernelInitialization->False]],
  DefaultBaseStyle->{
   "NetworkGraphics", FrontEnd`GraphicsHighlightColor -> Hue[0.8, 1., 0.6]},
  FormatType->TraditionalForm,
  FrameTicks->None,
  ImagePadding->25,
  ImageSize->800,
  PlotRange->All]], "Output",
 CellChangeTimes->{{3.863787822594028*^9, 3.863787843792837*^9}, 
   3.863787892336076*^9, {3.8637879841651163`*^9, 3.86378799543198*^9}},
 CellLabel->"Out[72]=",ExpressionUUID->"15d69380-704e-4750-9062-e6a50f075fd4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"connections", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"n", ",", "k", ",", "r"}], "}"}], ",", " ", "init", ",", " ", 
   "size", ",", " ", "3", ",", " ", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.863787907923562*^9, 3.863787909174679*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"1fb20d83-5a09-472b-9ad4-1a1f383c0474"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"213", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"212", ",", "2", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"212", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"208", ",", "2", ",", "1"}], "}"}]}], ",", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"208", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"240", ",", "2", ",", "1"}], "}"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.863787909550704*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"dee7cb92-60eb-4940-a841-6917f639b676"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1069, 764},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"bd35a28b-e084-4a45-9714-28c5e803eab9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 3, 67, "Section",ExpressionUUID->"4b052983-f7eb-4c60-b94e-63384307ec0d"],
Cell[CellGroupData[{
Cell[776, 29, 167, 3, 54, "Subsection",ExpressionUUID->"4c8aaee8-1ce5-4656-857a-0898d5b45ada"],
Cell[946, 34, 20277, 317, 357, "Code",ExpressionUUID->"85630bd6-46aa-4713-81d1-94737fa182d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21260, 356, 175, 3, 54, "Subsection",ExpressionUUID->"6cfa4382-e90d-462a-88b8-9a50eed0f152"],
Cell[21438, 361, 23392, 396, 661, "Code",ExpressionUUID->"5fb13b81-7d4f-4919-9146-b9d82449e1fc"],
Cell[44833, 759, 20140, 303, 262, "Code",ExpressionUUID->"0201e35e-88b4-4276-ae72-ec4fcb05987a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65022, 1068, 152, 3, 67, "Section",ExpressionUUID->"7f292310-35e5-45b2-9e92-d79c88665d9f"],
Cell[65177, 1073, 302, 6, 52, "Input",ExpressionUUID->"5dfa62a7-5dc2-4faf-a87f-26dd051fd5eb"],
Cell[CellGroupData[{
Cell[65504, 1083, 267, 5, 30, "Input",ExpressionUUID->"852c7602-fc85-44e9-b737-0d5fe80201d9"],
Cell[65774, 1090, 173, 2, 34, "Output",ExpressionUUID->"198b95d7-18be-43a7-a882-0de0a9f49d8b"]
}, Open  ]],
Cell[65962, 1095, 218, 4, 30, "Input",ExpressionUUID->"15e2fce2-4111-48b8-811d-50f7bbb613cc"],
Cell[CellGroupData[{
Cell[66205, 1103, 274, 5, 30, "Input",ExpressionUUID->"551224bf-6817-4da6-8dfb-95ce6a2bf8b9"],
Cell[66482, 1110, 748, 20, 34, "Output",ExpressionUUID->"5a87b23e-53eb-4a77-adf1-c4e1148c1aaf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67267, 1135, 280, 5, 30, "Input",ExpressionUUID->"42fe47a9-4526-4413-916a-5b35eced7820"],
Cell[67550, 1142, 286, 6, 34, "Output",ExpressionUUID->"6a795b4a-ea83-406f-8734-0f5609ca9179"]
}, Open  ]],
Cell[67851, 1151, 294, 6, 30, "Input",ExpressionUUID->"b1dbd5b7-84c3-4454-9dea-e4112083ba52"],
Cell[CellGroupData[{
Cell[68170, 1161, 319, 7, 30, "Input",ExpressionUUID->"c65ba51c-6fac-4ecd-bc92-ab452cd06d35"],
Cell[68492, 1170, 294, 6, 34, "Output",ExpressionUUID->"fa1ebefa-4684-4dd2-b090-b6e5be47452f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68823, 1181, 351, 7, 30, "Input",ExpressionUUID->"addf4d46-4984-4f97-8a33-7f59aec2eb32"],
Cell[69177, 1190, 280, 6, 34, "Output",ExpressionUUID->"e54bbcdb-90c9-45dc-87f0-213dc2c18261"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69494, 1201, 351, 8, 30, "Input",ExpressionUUID->"145e6ef0-6a9d-4b8f-b417-08ea758c5bf9"],
Cell[69848, 1211, 401, 8, 34, "Output",ExpressionUUID->"3ee152ed-d40e-43c6-8455-8f652950169a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70286, 1224, 595, 13, 30, "Input",ExpressionUUID->"f2ba3ca1-fdb5-43aa-bb5b-a557f89b9cac"],
Cell[70884, 1239, 674, 18, 34, "Output",ExpressionUUID->"1ec0b1fe-a1b1-407a-b39c-debf9bf92ca8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71595, 1262, 413, 8, 30, "Input",ExpressionUUID->"8f71fb2f-a70f-46ab-bf7a-c302524b379e"],
Cell[72011, 1272, 771, 21, 34, "Output",ExpressionUUID->"3bb13311-981d-4119-a938-4c3c2669bcec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72819, 1298, 351, 7, 30, "Input",ExpressionUUID->"f0d12818-0680-4260-b630-dd69e4840def"],
Cell[73173, 1307, 581, 17, 34, "Output",ExpressionUUID->"28c0501b-55bc-4982-8284-21b723384100"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73791, 1329, 351, 7, 30, "Input",ExpressionUUID->"2ba628a5-dd78-409f-aecd-ab44496df9f0"],
Cell[74145, 1338, 581, 17, 34, "Output",ExpressionUUID->"e420bda9-196e-4022-8b20-c977f9202762"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74763, 1360, 315, 6, 30, "Input",ExpressionUUID->"78f954c2-735a-450a-8a46-38891cd021d7"],
Cell[75081, 1368, 7377, 151, 67, "Output",ExpressionUUID->"ab48601f-08c9-41a3-a64f-80b36250562e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82495, 1524, 313, 6, 30, "Input",ExpressionUUID->"c172e565-73c7-41bc-8cfb-169b4e155b98"],
Cell[82811, 1532, 7377, 151, 67, "Output",ExpressionUUID->"bb4d0c1f-fed6-4073-bb36-c71b8f84ff1c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[90225, 1688, 408, 8, 30, "Input",ExpressionUUID->"928e0dda-0495-4e2b-a2d1-28b9b85f7e9c"],
Cell[90636, 1698, 5990, 132, 96, "Output",ExpressionUUID->"15d69380-704e-4750-9062-e6a50f075fd4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96663, 1835, 351, 7, 30, "Input",ExpressionUUID->"1fb20d83-5a09-472b-9ad4-1a1f383c0474"],
Cell[97017, 1844, 672, 19, 34, "Output",ExpressionUUID->"dee7cb92-60eb-4940-a841-6917f639b676"]
}, Open  ]]
}, Open  ]]
}
]
*)

