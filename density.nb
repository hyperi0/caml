(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61036,       1073]
NotebookOptionsPosition[     59653,       1040]
NotebookOutlinePosition[     60044,       1056]
CellTagsIndexPosition[     60001,       1053]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Increment Implementation", "Section",
 CellChangeTimes->{{3.863519660808393*^9, 
  3.8635196668701773`*^9}},ExpressionUUID->"4b052983-f7eb-4c60-b94e-\
63384307ec0d"],

Cell[CellGroupData[{

Cell["Constants", "Subsection",
 CellChangeTimes->{{3.863519417003643*^9, 
  3.8635194182094*^9}},ExpressionUUID->"ce98e1f7-7289-409a-af7d-0f02a4d912ab"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"size", "=", "50"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"size", " ", "of", " ", "square", " ", 
    RowBox[{"CA", "'"}], "s", " ", "to", " ", "be", " ", "tested"}], " ", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"colors", "=", "3"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"possible", " ", "colors", " ", "for", " ", "CA"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"radius", "=", "1"}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"radius", " ", "of", " ", "rule"}], " ", "-", " ", 
     RowBox[{"1", " ", "is", " ", "nearest", " ", "neighbor"}]}], ",", " ", 
    RowBox[{
     RowBox[{"2", " ", "is", " ", "next"}], "-", "nearest"}], ",", " ", 
    RowBox[{
     RowBox[{"etc", ".", " ", "This"}], " ", "is", " ", "really", " ", "slow",
      " ", "if", " ", 
     RowBox[{"it", "'"}], "s", " ", "bigger", " ", "than", " ", "1"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"max", "=", 
   RowBox[{"colors", "^", 
    RowBox[{"colors", "^", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", "radius"}], "+", "1"}], ")"}]}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "max", " ", "rule", " ", "number", " ", "in", " ", "base", " ", "10"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"initial", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"colors", "-", "1"}], ",", "size"}], "]"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"random", " ", "initial", " ", "condition"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ruleLen", "=", 
   RowBox[{"colors", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "radius"}], "+", "1"}], ")"}]}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "blocks", " ", 
    RowBox[{"(", 
     RowBox[{"possible", " ", "replacements"}], ")"}], " ", "in", " ", 
    "rule"}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{{3.770482787643997*^9, 3.770482921097328*^9}, {
   3.770482959794046*^9, 3.770483062443226*^9}, {3.770483139105879*^9, 
   3.770483142791513*^9}, {3.7704833713411627`*^9, 3.770483604393207*^9}, {
   3.770483652477036*^9, 3.770483668514173*^9}, {3.7704837314588003`*^9, 
   3.770483760241007*^9}, {3.77048379348855*^9, 3.770483818784292*^9}, {
   3.770483886037365*^9, 3.77048391704599*^9}, {3.770483982730173*^9, 
   3.770484041007475*^9}, {3.77048412028379*^9, 3.7704841228226023`*^9}, {
   3.770484218139017*^9, 3.770484239373794*^9}, {3.7704842830675592`*^9, 
   3.770484335072513*^9}, {3.770484689868153*^9, 3.770484707338176*^9}, {
   3.7704858240605583`*^9, 3.77048583343545*^9}, {3.77048590141014*^9, 
   3.770485901723312*^9}, {3.770486365317235*^9, 3.7704863665313587`*^9}, 
   3.770494386502613*^9, {3.770494470707664*^9, 3.770494645630993*^9}, {
   3.770494689386427*^9, 3.770494765588149*^9}, {3.7704948516503*^9, 
   3.770494888375936*^9}, {3.770494921269123*^9, 3.770495029608489*^9}, {
   3.7704950624466133`*^9, 3.770495141583098*^9}, {3.77049519230225*^9, 
   3.7704952643574133`*^9}, {3.770495449922097*^9, 3.7704955008340197`*^9}, {
   3.770495564766152*^9, 3.770495578779191*^9}, {3.770495620880939*^9, 
   3.770495654324613*^9}, 3.770546148986672*^9, 3.7705464136378736`*^9, {
   3.7705464597370453`*^9, 3.770546469723206*^9}, {3.770546510288927*^9, 
   3.770546531072365*^9}, {3.7705499059866543`*^9, 3.7705499209635277`*^9}, {
   3.770646995775899*^9, 3.770647162029993*^9}, {3.770647226016552*^9, 
   3.7706472960607977`*^9}, {3.770647344322225*^9, 3.770647427912814*^9}, {
   3.7706474763262453`*^9, 3.7706475285312357`*^9}, {3.770647579226934*^9, 
   3.7706475825076523`*^9}, {3.770647635720187*^9, 3.770647641473075*^9}, {
   3.770647712413559*^9, 3.77064771712294*^9}, {3.770647863127544*^9, 
   3.770647865474045*^9}, {3.770648147609572*^9, 3.7706481483061523`*^9}, {
   3.770648194531769*^9, 3.77064819764957*^9}, {3.7706482295255404`*^9, 
   3.770648251796324*^9}, {3.770648285676703*^9, 3.770648287071795*^9}, {
   3.7706483844894037`*^9, 3.770648408310869*^9}, {3.770648474457296*^9, 
   3.77064849181185*^9}, {3.77064919951954*^9, 3.770649219260521*^9}, {
   3.771012572080574*^9, 3.771012574557795*^9}, {3.7710130892382*^9, 
   3.7710131278577003`*^9}, {3.771013164671421*^9, 3.771013170662612*^9}, {
   3.771013241398697*^9, 3.771013293093876*^9}, {3.771013376828169*^9, 
   3.771013408917551*^9}, {3.771066027911306*^9, 3.7710660563644667`*^9}, {
   3.771066088967906*^9, 3.771066126393922*^9}, {3.771066304209084*^9, 
   3.771066417760647*^9}, {3.7710665061651993`*^9, 3.77106651827633*^9}, {
   3.7710665958461657`*^9, 3.771066599592246*^9}, {3.771066787106886*^9, 
   3.77106688118673*^9}, {3.771066917958227*^9, 3.771066920163258*^9}, {
   3.771066961041355*^9, 3.7710669697386007`*^9}, {3.771067019870351*^9, 
   3.771067054186266*^9}, {3.771067596745988*^9, 3.771067608539199*^9}, {
   3.7710677999321203`*^9, 3.771067828462199*^9}, {3.7710691448181763`*^9, 
   3.771069146191324*^9}, {3.771069401140826*^9, 3.7710694192296677`*^9}, {
   3.7710694544712057`*^9, 3.77106946175102*^9}, {3.771069510407185*^9, 
   3.771069546377035*^9}, {3.771069588713119*^9, 3.771069623729661*^9}, {
   3.7710777912034283`*^9, 3.771077797514872*^9}, {3.771077857747775*^9, 
   3.771077896683793*^9}, {3.7710779846984587`*^9, 3.7710780571582336`*^9}, {
   3.7710780916296473`*^9, 3.771078093185443*^9}, {3.771078157306479*^9, 
   3.7710783469069242`*^9}, {3.771078546205811*^9, 3.771078555275388*^9}, 
   3.771078785346652*^9, {3.771079086436943*^9, 3.771079086531608*^9}, {
   3.7710792132061577`*^9, 3.771079264419251*^9}, {3.7710796746024218`*^9, 
   3.77107985049893*^9}, {3.771079980556774*^9, 3.77108000254884*^9}, {
   3.771080037566615*^9, 3.771080126810281*^9}, {3.7710801647208*^9, 
   3.7710801660741787`*^9}, {3.771080197507674*^9, 3.7710802250598183`*^9}, {
   3.771080267960541*^9, 3.771080359083398*^9}, {3.771080406249712*^9, 
   3.771080421234771*^9}, {3.7710804782287493`*^9, 3.771080592180871*^9}, {
   3.7710806420884533`*^9, 3.771080643782098*^9}, {3.771080707357484*^9, 
   3.7710807526840153`*^9}, {3.771080786460499*^9, 3.7710807865927343`*^9}, {
   3.771080854778215*^9, 3.77108095974751*^9}, {3.7710810202456903`*^9, 
   3.771081023112467*^9}, {3.771081074111945*^9, 3.7710810835969048`*^9}, {
   3.7710813979098043`*^9, 3.771081432278171*^9}, {3.771081466981485*^9, 
   3.7710814671031923`*^9}, {3.771081505139979*^9, 3.771081583240635*^9}, {
   3.771081685649589*^9, 3.771081701105802*^9}, {3.771081759414233*^9, 
   3.771081781046382*^9}, {3.771081920400188*^9, 3.771081923433948*^9}, {
   3.771102715133277*^9, 3.7711027957900267`*^9}, {3.771102842399693*^9, 
   3.771102881808381*^9}, {3.771102929227768*^9, 3.7711029691401367`*^9}, {
   3.771103073447472*^9, 3.771103086180725*^9}, {3.7711031176933737`*^9, 
   3.771103123767542*^9}, {3.7711031660546627`*^9, 3.7711031834026413`*^9}, {
   3.7711032291580553`*^9, 3.7711034631767817`*^9}, {3.771103551409133*^9, 
   3.7711035565488443`*^9}, {3.771103589768116*^9, 3.771103643377743*^9}, {
   3.771104123721092*^9, 3.7711041535912523`*^9}, 3.7711042972171087`*^9, {
   3.771104442098654*^9, 3.7711044613789263`*^9}, {3.77110469507471*^9, 
   3.771104742941822*^9}, {3.771104774170217*^9, 3.77110482732683*^9}, {
   3.771155075730083*^9, 3.77115510319302*^9}, {3.7711552204793873`*^9, 
   3.771155256265522*^9}, {3.771155315803068*^9, 3.771155317177318*^9}, {
   3.771155352667796*^9, 3.7711554504442596`*^9}, {3.771155487442925*^9, 
   3.771155490673388*^9}, {3.771155532866001*^9, 3.7711555903371677`*^9}, {
   3.771155628649703*^9, 3.771155834814893*^9}, {3.7711558698054256`*^9, 
   3.7711559269158163`*^9}, 3.7711559705399923`*^9, {3.771156007382532*^9, 
   3.771156011094149*^9}, {3.771156048765955*^9, 3.771156049264926*^9}, {
   3.771156096767069*^9, 3.771156096825408*^9}, {3.7711561514908113`*^9, 
   3.77115623471835*^9}, {3.771156280227399*^9, 3.771156289782609*^9}, {
   3.771156373415247*^9, 3.7711563734818172`*^9}, {3.771156419112504*^9, 
   3.771156440871361*^9}, {3.771156495007992*^9, 3.7711565545108624`*^9}, {
   3.771156592609713*^9, 3.7711565927161903`*^9}, {3.771156768188053*^9, 
   3.771156795051096*^9}, 3.771156999731532*^9, {3.771157045274468*^9, 
   3.771157045541771*^9}, {3.771157114755713*^9, 3.771157137928946*^9}, 
   3.7711600338876333`*^9, {3.771242096819364*^9, 3.771242126195787*^9}, {
   3.771242256031309*^9, 3.771242258590022*^9}, {3.771242409531823*^9, 
   3.771242427172946*^9}, {3.771242887847391*^9, 3.7712430086268187`*^9}, 
   3.7712430584239273`*^9, {3.771243106934415*^9, 3.771243107568427*^9}, {
   3.7712431714277573`*^9, 3.771243197952642*^9}, {3.771244552432255*^9, 
   3.771244577042035*^9}, {3.77142514036493*^9, 3.771425142502884*^9}, {
   3.7714251943895397`*^9, 3.771425215829914*^9}, {3.77142527264194*^9, 
   3.7714253037709*^9}, {3.771425370795764*^9, 3.771425408257433*^9}, {
   3.771425440099287*^9, 3.7714254402688704`*^9}, {3.771425473750928*^9, 
   3.7714255960830173`*^9}, {3.771425631818544*^9, 3.771425675253339*^9}, {
   3.771425719721884*^9, 3.771425740883687*^9}, {3.77142580515589*^9, 
   3.7714258447466307`*^9}, {3.771425981145659*^9, 3.771426077771694*^9}, {
   3.771426125827806*^9, 3.771426127166316*^9}, {3.7714261869034653`*^9, 
   3.77142620723772*^9}, {3.7714262758003807`*^9, 3.77142627714293*^9}, {
   3.771426320226757*^9, 3.771426324649633*^9}, {3.771426394553677*^9, 
   3.771426422846036*^9}, {3.7714264814633904`*^9, 3.771426484560677*^9}, {
   3.7714265255888844`*^9, 3.77142656450191*^9}, {3.77142666832382*^9, 
   3.771426701226253*^9}, {3.7714267992888727`*^9, 3.771426802098439*^9}, {
   3.771426837696424*^9, 3.77142684252494*^9}, {3.771426881502282*^9, 
   3.77142689463704*^9}, {3.771426944474209*^9, 3.771426954837367*^9}, {
   3.771427085611624*^9, 3.771427208321937*^9}, {3.77142725982743*^9, 
   3.771427342676564*^9}, {3.771427387096983*^9, 3.77142741387674*^9}, {
   3.7714274823067417`*^9, 3.771427620083233*^9}, {3.771427650958089*^9, 
   3.771427735642126*^9}, {3.771427811732935*^9, 3.7714278281384907`*^9}, {
   3.771427984750801*^9, 3.771428010767819*^9}, {3.771428145789899*^9, 
   3.771428219232523*^9}, {3.77142845337399*^9, 3.771428832443232*^9}, {
   3.77142919635216*^9, 3.7714292167538853`*^9}, {3.771429255809939*^9, 
   3.771429255862849*^9}, {3.771429324211997*^9, 3.771429324566071*^9}, {
   3.771429398212832*^9, 3.771429402512352*^9}, {3.771429442429163*^9, 
   3.7714294540990467`*^9}, 3.7714294941500063`*^9, {3.771429539657894*^9, 
   3.7714295405513687`*^9}, {3.771429618724918*^9, 3.771429623261997*^9}, {
   3.7714307899835873`*^9, 3.771430790436494*^9}, 3.771451104216363*^9, {
   3.771508095448917*^9, 3.771508110132432*^9}, {3.7715083225896187`*^9, 
   3.7715083306779222`*^9}, {3.771508374776663*^9, 3.771508386277514*^9}, {
   3.7715084270778646`*^9, 3.771508512389296*^9}, 3.771508543555127*^9, {
   3.77150858570796*^9, 3.771508618994934*^9}, {3.7715088207169943`*^9, 
   3.77150889031539*^9}, {3.771508923322143*^9, 3.771508923670087*^9}, 
   3.771508953753009*^9, 3.771509016175152*^9, 3.7715091247344227`*^9, {
   3.771509280836137*^9, 3.7715093899531307`*^9}, {3.771509422527775*^9, 
   3.771509422567185*^9}, {3.771509493986957*^9, 3.7715096052550087`*^9}, {
   3.771509653971591*^9, 3.771509693979186*^9}, {3.77150973259478*^9, 
   3.77150990173524*^9}, {3.771510004414825*^9, 3.771510008024968*^9}, 
   3.771510097994895*^9, 3.771510166795833*^9, 3.771510435525115*^9, {
   3.771510592878343*^9, 3.7715105957468767`*^9}, {3.7715107677541*^9, 
   3.771510769561739*^9}, {3.77151081284661*^9, 3.7715108155415583`*^9}, {
   3.7715108821134987`*^9, 3.7715109302915382`*^9}, {3.771510964009658*^9, 
   3.771510971129046*^9}, {3.771511010046406*^9, 3.7715110353755198`*^9}, {
   3.771511088136096*^9, 3.771511102886223*^9}, {3.7715114300949583`*^9, 
   3.771511430126233*^9}, {3.771511497625127*^9, 3.7715115693777018`*^9}, {
   3.771511643172413*^9, 3.771511646783353*^9}, {3.771511678993891*^9, 
   3.771511680277672*^9}, 3.7715127192809067`*^9, {3.771512800048661*^9, 
   3.7715128026246967`*^9}, {3.771512870902679*^9, 3.771512909102131*^9}, 
   3.771521512787075*^9, {3.771521627383951*^9, 3.771521629777337*^9}, 
   3.771521880408036*^9, {3.7716936365224733`*^9, 3.771693638595093*^9}, {
   3.771709640748691*^9, 3.77170966741654*^9}, 3.771712679383781*^9, 
   3.771715174251409*^9, {3.771715237009747*^9, 3.771715237058792*^9}, {
   3.771715339730751*^9, 3.77171535647466*^9}, {3.771770825160698*^9, 
   3.7717708376643267`*^9}, {3.771771086491645*^9, 3.771771087704645*^9}, {
   3.771771122266552*^9, 3.771771122429655*^9}, {3.863519413566153*^9, 
   3.863519415053197*^9}, {3.863520253059301*^9, 3.8635202539783583`*^9}, {
   3.8635204400686274`*^9, 3.863520461289611*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"8bf4f650-2ca6-49e6-856b-3ffd0cb6832a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["CA Base Functions", "Subsection",
 CellChangeTimes->{{3.8635194098090143`*^9, 
  3.863519411852273*^9}},ExpressionUUID->"4c8aaee8-1ce5-4656-857a-\
0898d5b45ada"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"randomly", " ", "select", " ", "a", " ", "rule"}], " ", "*)"}], 
  "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"getRule", "[", "]"}], ":=", "\n", "\t", 
    RowBox[{"RandomInteger", "[", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"max", "-", "1"}]}], "}"}], "]"}]}], "\[IndentingNewLine]", 
   "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "all", " ", "blocks", " ", "of", " ", "cells", " ", "in", " ", "the", " ",
      "rule"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"getBlocks", "[", "]"}], ":=", "\n", "\t", 
    RowBox[{"Tuples", "[", 
     RowBox[{
      RowBox[{"Reverse", "[", 
       RowBox[{"Range", "[", 
        RowBox[{"0", ",", 
         RowBox[{"colors", "-", "1"}], ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"2", "*", "radius"}], "+", "1"}]}], "]"}]}], " ", "\n", "\t", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "rule", " ", "in", " ", "base", " ", "of", " ", "#", " ", "colors"}], " ",
     "*)"}], "\n", 
   RowBox[{
    RowBox[{"ruleDigits", "[", "rule_", "]"}], ":=", 
    RowBox[{
     RowBox[{"ruleDigits", "[", "rule", "]"}], "=", "\n", "\t", 
     RowBox[{"IntegerDigits", "[", 
      RowBox[{"rule", ",", "colors", ",", "ruleLen"}], "]"}]}]}], "\n", "\n", 
   
   RowBox[{"(*", " ", 
    RowBox[{
    "matrix", " ", "containing", " ", "colors", " ", "of", " ", "CA", " ", 
     "after", " ", "set", " ", "number", " ", "of", " ", "steps"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"cellGrid", "[", "rule_", "]"}], ":=", 
    RowBox[{
     RowBox[{"cellGrid", "[", "rule", "]"}], "=", "\n", "\t", 
     RowBox[{"CellularAutomaton", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"rule", ",", "colors", ",", "radius"}], "}"}], ",", "initial",
        ",", " ", 
       RowBox[{"size", "-", "1"}]}], "]"}]}]}], " ", "\n", "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"get", " ", "ruleplot"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"showRule", "[", "rule_", "]"}], ":=", "\n", "\t", 
    RowBox[{"RulePlot", "[", 
     RowBox[{"CellularAutomaton", "[", 
      RowBox[{"{", 
       RowBox[{"rule", ",", "colors", ",", "radius"}], "}"}], "]"}], "]"}]}], 
   " ", "\n", "\t", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"show", " ", "CA", " ", "with", " ", "rule", " ", "number"}], 
     ",", " ", 
     RowBox[{"visual", " ", "rule"}], ",", " ", 
     RowBox[{"and", " ", "visual", " ", "grid"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"showCA", "[", "rule_", "]"}], ":=", "\n", "\t", 
    RowBox[{"ArrayPlot", "[", 
     RowBox[{"cellGrid", "[", "rule", "]"}], "]"}]}], " ", "\n", "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "ratio", " ", "of", " ", "uncompressed", " ", "to", " ", "compressed", 
      " ", "size", " ", "of", " ", "CA"}], ",", " ", 
     RowBox[{"good", " ", "measure", " ", "for", " ", "classification"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"compressionRatio", "[", "ca_", "]"}], ":=", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ByteCount", "[", "ca", "]"}], "/", 
       RowBox[{"ByteCount", "[", 
        RowBox[{"Compress", "[", "ca", "]"}], "]"}]}], ",", " ", "4"}], 
     "]"}]}], " ", "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "measure", " ", "of", " ", "difference", " ", "between", " ", "rules", 
      " ", "by", " ", "summing", " ", "squares", " ", "of", " ", 
      "differences", " ", "between", " ", "rule", " ", "applications"}], " ", 
     "-", " ", 
     RowBox[{"currently", " ", "unused"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"difference", "[", 
     RowBox[{"rule_", ",", "newRule_"}], "]"}], ":=", 
    RowBox[{"Total", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{
       RowBox[{"countUses", "[", "rule", "]"}], "-", 
       RowBox[{"countUses", "[", "newRule", "]"}]}], "]"}], "]"}], 
    " "}]}]}]], "Code",
 CellChangeTimes->{{3.770482787643997*^9, 3.770482921097328*^9}, {
   3.770482959794046*^9, 3.770483062443226*^9}, {3.770483139105879*^9, 
   3.770483142791513*^9}, {3.7704833713411627`*^9, 3.770483604393207*^9}, {
   3.770483652477036*^9, 3.770483668514173*^9}, {3.7704837314588003`*^9, 
   3.770483760241007*^9}, {3.77048379348855*^9, 3.770483818784292*^9}, {
   3.770483886037365*^9, 3.77048391704599*^9}, {3.770483982730173*^9, 
   3.770484041007475*^9}, {3.77048412028379*^9, 3.7704841228226023`*^9}, {
   3.770484218139017*^9, 3.770484239373794*^9}, {3.7704842830675592`*^9, 
   3.770484335072513*^9}, {3.770484689868153*^9, 3.770484707338176*^9}, {
   3.7704858240605583`*^9, 3.77048583343545*^9}, {3.77048590141014*^9, 
   3.770485901723312*^9}, {3.770486365317235*^9, 3.7704863665313587`*^9}, 
   3.770494386502613*^9, {3.770494470707664*^9, 3.770494645630993*^9}, {
   3.770494689386427*^9, 3.770494765588149*^9}, {3.7704948516503*^9, 
   3.770494888375936*^9}, {3.770494921269123*^9, 3.770495029608489*^9}, {
   3.7704950624466133`*^9, 3.770495141583098*^9}, {3.77049519230225*^9, 
   3.7704952643574133`*^9}, {3.770495449922097*^9, 3.7704955008340197`*^9}, {
   3.770495564766152*^9, 3.770495578779191*^9}, {3.770495620880939*^9, 
   3.770495654324613*^9}, 3.770546148986672*^9, 3.7705464136378736`*^9, {
   3.7705464597370453`*^9, 3.770546469723206*^9}, {3.770546510288927*^9, 
   3.770546531072365*^9}, {3.7705499059866543`*^9, 3.7705499209635277`*^9}, {
   3.770646995775899*^9, 3.770647162029993*^9}, {3.770647226016552*^9, 
   3.7706472960607977`*^9}, {3.770647344322225*^9, 3.770647427912814*^9}, {
   3.7706474763262453`*^9, 3.7706475285312357`*^9}, {3.770647579226934*^9, 
   3.7706475825076523`*^9}, {3.770647635720187*^9, 3.770647641473075*^9}, {
   3.770647712413559*^9, 3.77064771712294*^9}, {3.770647863127544*^9, 
   3.770647865474045*^9}, {3.770648147609572*^9, 3.7706481483061523`*^9}, {
   3.770648194531769*^9, 3.77064819764957*^9}, {3.7706482295255404`*^9, 
   3.770648251796324*^9}, {3.770648285676703*^9, 3.770648287071795*^9}, {
   3.7706483844894037`*^9, 3.770648408310869*^9}, {3.770648474457296*^9, 
   3.77064849181185*^9}, {3.77064919951954*^9, 3.770649219260521*^9}, {
   3.771012572080574*^9, 3.771012574557795*^9}, {3.7710130892382*^9, 
   3.7710131278577003`*^9}, {3.771013164671421*^9, 3.771013170662612*^9}, {
   3.771013241398697*^9, 3.771013293093876*^9}, {3.771013376828169*^9, 
   3.771013408917551*^9}, {3.771066027911306*^9, 3.7710660563644667`*^9}, {
   3.771066088967906*^9, 3.771066126393922*^9}, {3.771066304209084*^9, 
   3.771066417760647*^9}, {3.7710665061651993`*^9, 3.77106651827633*^9}, {
   3.7710665958461657`*^9, 3.771066599592246*^9}, {3.771066787106886*^9, 
   3.77106688118673*^9}, {3.771066917958227*^9, 3.771066920163258*^9}, {
   3.771066961041355*^9, 3.7710669697386007`*^9}, {3.771067019870351*^9, 
   3.771067054186266*^9}, {3.771067596745988*^9, 3.771067608539199*^9}, {
   3.7710677999321203`*^9, 3.771067828462199*^9}, {3.7710691448181763`*^9, 
   3.771069146191324*^9}, {3.771069401140826*^9, 3.7710694192296677`*^9}, {
   3.7710694544712057`*^9, 3.77106946175102*^9}, {3.771069510407185*^9, 
   3.771069546377035*^9}, {3.771069588713119*^9, 3.771069623729661*^9}, {
   3.7710777912034283`*^9, 3.771077797514872*^9}, {3.771077857747775*^9, 
   3.771077896683793*^9}, {3.7710779846984587`*^9, 3.7710780571582336`*^9}, {
   3.7710780916296473`*^9, 3.771078093185443*^9}, {3.771078157306479*^9, 
   3.7710783469069242`*^9}, {3.771078546205811*^9, 3.771078555275388*^9}, 
   3.771078785346652*^9, {3.771079086436943*^9, 3.771079086531608*^9}, {
   3.7710792132061577`*^9, 3.771079264419251*^9}, {3.7710796746024218`*^9, 
   3.77107985049893*^9}, {3.771079980556774*^9, 3.77108000254884*^9}, {
   3.771080037566615*^9, 3.771080126810281*^9}, {3.7710801647208*^9, 
   3.7710801660741787`*^9}, {3.771080197507674*^9, 3.7710802250598183`*^9}, {
   3.771080267960541*^9, 3.771080359083398*^9}, {3.771080406249712*^9, 
   3.771080421234771*^9}, {3.7710804782287493`*^9, 3.771080592180871*^9}, {
   3.7710806420884533`*^9, 3.771080643782098*^9}, {3.771080707357484*^9, 
   3.7710807526840153`*^9}, {3.771080786460499*^9, 3.7710807865927343`*^9}, {
   3.771080854778215*^9, 3.77108095974751*^9}, {3.7710810202456903`*^9, 
   3.771081023112467*^9}, {3.771081074111945*^9, 3.7710810835969048`*^9}, {
   3.7710813979098043`*^9, 3.771081432278171*^9}, {3.771081466981485*^9, 
   3.7710814671031923`*^9}, {3.771081505139979*^9, 3.771081583240635*^9}, {
   3.771081685649589*^9, 3.771081701105802*^9}, {3.771081759414233*^9, 
   3.771081781046382*^9}, {3.771081920400188*^9, 3.771081923433948*^9}, {
   3.771102715133277*^9, 3.7711027957900267`*^9}, {3.771102842399693*^9, 
   3.771102881808381*^9}, {3.771102929227768*^9, 3.7711029691401367`*^9}, {
   3.771103073447472*^9, 3.771103086180725*^9}, {3.7711031176933737`*^9, 
   3.771103123767542*^9}, {3.7711031660546627`*^9, 3.7711031834026413`*^9}, {
   3.7711032291580553`*^9, 3.7711034631767817`*^9}, {3.771103551409133*^9, 
   3.7711035565488443`*^9}, {3.771103589768116*^9, 3.771103643377743*^9}, {
   3.771104123721092*^9, 3.7711041535912523`*^9}, 3.7711042972171087`*^9, {
   3.771104442098654*^9, 3.7711044613789263`*^9}, {3.77110469507471*^9, 
   3.771104742941822*^9}, {3.771104774170217*^9, 3.77110482732683*^9}, {
   3.771155075730083*^9, 3.77115510319302*^9}, {3.7711552204793873`*^9, 
   3.771155256265522*^9}, {3.771155315803068*^9, 3.771155317177318*^9}, {
   3.771155352667796*^9, 3.7711554504442596`*^9}, {3.771155487442925*^9, 
   3.771155490673388*^9}, {3.771155532866001*^9, 3.7711555903371677`*^9}, {
   3.771155628649703*^9, 3.771155834814893*^9}, {3.7711558698054256`*^9, 
   3.7711559269158163`*^9}, 3.7711559705399923`*^9, {3.771156007382532*^9, 
   3.771156011094149*^9}, {3.771156048765955*^9, 3.771156049264926*^9}, {
   3.771156096767069*^9, 3.771156096825408*^9}, {3.7711561514908113`*^9, 
   3.77115623471835*^9}, {3.771156280227399*^9, 3.771156289782609*^9}, {
   3.771156373415247*^9, 3.7711563734818172`*^9}, {3.771156419112504*^9, 
   3.771156440871361*^9}, {3.771156495007992*^9, 3.7711565545108624`*^9}, {
   3.771156592609713*^9, 3.7711565927161903`*^9}, {3.771156768188053*^9, 
   3.771156795051096*^9}, 3.771156999731532*^9, {3.771157045274468*^9, 
   3.771157045541771*^9}, {3.771157114755713*^9, 3.771157137928946*^9}, 
   3.7711600338876333`*^9, {3.771242096819364*^9, 3.771242126195787*^9}, {
   3.771242256031309*^9, 3.771242258590022*^9}, {3.771242409531823*^9, 
   3.771242427172946*^9}, {3.771242887847391*^9, 3.7712430086268187`*^9}, 
   3.7712430584239273`*^9, {3.771243106934415*^9, 3.771243107568427*^9}, {
   3.7712431714277573`*^9, 3.771243197952642*^9}, {3.771244552432255*^9, 
   3.771244577042035*^9}, {3.77142514036493*^9, 3.771425142502884*^9}, {
   3.7714251943895397`*^9, 3.771425215829914*^9}, {3.77142527264194*^9, 
   3.7714253037709*^9}, {3.771425370795764*^9, 3.771425408257433*^9}, {
   3.771425440099287*^9, 3.7714254402688704`*^9}, {3.771425473750928*^9, 
   3.7714255960830173`*^9}, {3.771425631818544*^9, 3.771425675253339*^9}, {
   3.771425719721884*^9, 3.771425740883687*^9}, {3.77142580515589*^9, 
   3.7714258447466307`*^9}, {3.771425981145659*^9, 3.771426077771694*^9}, {
   3.771426125827806*^9, 3.771426127166316*^9}, {3.7714261869034653`*^9, 
   3.77142620723772*^9}, {3.7714262758003807`*^9, 3.77142627714293*^9}, {
   3.771426320226757*^9, 3.771426324649633*^9}, {3.771426394553677*^9, 
   3.771426422846036*^9}, {3.7714264814633904`*^9, 3.771426484560677*^9}, {
   3.7714265255888844`*^9, 3.77142656450191*^9}, {3.77142666832382*^9, 
   3.771426701226253*^9}, {3.7714267992888727`*^9, 3.771426802098439*^9}, {
   3.771426837696424*^9, 3.77142684252494*^9}, {3.771426881502282*^9, 
   3.77142689463704*^9}, {3.771426944474209*^9, 3.771426954837367*^9}, {
   3.771427085611624*^9, 3.771427208321937*^9}, {3.77142725982743*^9, 
   3.771427342676564*^9}, {3.771427387096983*^9, 3.77142741387674*^9}, {
   3.7714274823067417`*^9, 3.771427620083233*^9}, {3.771427650958089*^9, 
   3.771427735642126*^9}, {3.771427811732935*^9, 3.7714278281384907`*^9}, {
   3.771427984750801*^9, 3.771428010767819*^9}, {3.771428145789899*^9, 
   3.771428219232523*^9}, {3.77142845337399*^9, 3.771428832443232*^9}, {
   3.77142919635216*^9, 3.7714292167538853`*^9}, {3.771429255809939*^9, 
   3.771429255862849*^9}, {3.771429324211997*^9, 3.771429324566071*^9}, {
   3.771429398212832*^9, 3.771429402512352*^9}, {3.771429442429163*^9, 
   3.7714294540990467`*^9}, 3.7714294941500063`*^9, {3.771429539657894*^9, 
   3.7714295405513687`*^9}, {3.771429618724918*^9, 3.771429623261997*^9}, {
   3.7714307899835873`*^9, 3.771430790436494*^9}, 3.771451104216363*^9, {
   3.771508095448917*^9, 3.771508110132432*^9}, {3.7715083225896187`*^9, 
   3.7715083306779222`*^9}, {3.771508374776663*^9, 3.771508386277514*^9}, {
   3.7715084270778646`*^9, 3.771508512389296*^9}, 3.771508543555127*^9, {
   3.77150858570796*^9, 3.771508618994934*^9}, {3.7715088207169943`*^9, 
   3.77150889031539*^9}, {3.771508923322143*^9, 3.771508923670087*^9}, 
   3.771508953753009*^9, 3.771509016175152*^9, 3.7715091247344227`*^9, {
   3.771509280836137*^9, 3.7715093899531307`*^9}, {3.771509422527775*^9, 
   3.771509422567185*^9}, {3.771509493986957*^9, 3.7715096052550087`*^9}, {
   3.771509653971591*^9, 3.771509693979186*^9}, {3.77150973259478*^9, 
   3.77150990173524*^9}, {3.771510004414825*^9, 3.771510008024968*^9}, 
   3.771510097994895*^9, 3.771510166795833*^9, 3.771510435525115*^9, {
   3.771510592878343*^9, 3.7715105957468767`*^9}, {3.7715107677541*^9, 
   3.771510769561739*^9}, {3.77151081284661*^9, 3.7715108155415583`*^9}, {
   3.7715108821134987`*^9, 3.7715109302915382`*^9}, {3.771510964009658*^9, 
   3.771510971129046*^9}, {3.771511010046406*^9, 3.7715110353755198`*^9}, {
   3.771511088136096*^9, 3.771511102886223*^9}, {3.7715114300949583`*^9, 
   3.771511430126233*^9}, {3.771511497625127*^9, 3.7715115693777018`*^9}, {
   3.771511643172413*^9, 3.771511646783353*^9}, {3.771511678993891*^9, 
   3.771511680277672*^9}, 3.7715127192809067`*^9, {3.771512800048661*^9, 
   3.7715128026246967`*^9}, {3.771512870902679*^9, 3.771512913650139*^9}, {
   3.7715133261672697`*^9, 3.7715133314839773`*^9}, 3.771513492252378*^9, {
   3.771514518198213*^9, 3.7715145227679043`*^9}, {3.77151708493652*^9, 
   3.771517087523554*^9}, {3.771517126782735*^9, 3.771517128810008*^9}, {
   3.771517210341956*^9, 3.7715172460665407`*^9}, {3.771517282285139*^9, 
   3.7715173175659246`*^9}, {3.771517350871862*^9, 3.771517380625053*^9}, {
   3.7715175364523573`*^9, 3.77151760571542*^9}, {3.771517640074253*^9, 
   3.7715176411021967`*^9}, {3.7715176899659986`*^9, 3.771517690090538*^9}, {
   3.7715177712211246`*^9, 3.771517772849249*^9}, 3.7715179959744*^9, {
   3.771518135783963*^9, 3.771518137899392*^9}, {3.7715184814367847`*^9, 
   3.771518486933831*^9}, {3.771518845518941*^9, 3.771518853375394*^9}, {
   3.771519841748459*^9, 3.771519843226256*^9}, {3.771520014828779*^9, 
   3.771520023308147*^9}, {3.771520059011042*^9, 3.7715201019782476`*^9}, {
   3.771520273028158*^9, 3.771520279593449*^9}, {3.771520883693551*^9, 
   3.7715208856464148`*^9}, {3.771520929250544*^9, 3.771520982269124*^9}, {
   3.771521188240921*^9, 3.771521191230611*^9}, {3.7715215916037903`*^9, 
   3.7715216236153183`*^9}, {3.7715219556354227`*^9, 
   3.7715219569119167`*^9}, {3.7715219940893173`*^9, 3.771522004818063*^9}, {
   3.771522127564417*^9, 3.771522133178886*^9}, {3.771522237696827*^9, 
   3.771522242483397*^9}, {3.771522476907035*^9, 3.7715224806870003`*^9}, {
   3.771612023511445*^9, 3.771612031753702*^9}, {3.771612079472707*^9, 
   3.7716120893051157`*^9}, {3.7716224793342648`*^9, 3.771622480136241*^9}, {
   3.771622883240336*^9, 3.7716228933155813`*^9}, {3.7716237449938374`*^9, 
   3.771623747126918*^9}, {3.771623796412709*^9, 3.771623799136798*^9}, {
   3.771624309956813*^9, 3.771624313155792*^9}, {3.7716243671319427`*^9, 
   3.771624385215858*^9}, {3.7716254457528887`*^9, 3.7716254552861023`*^9}, {
   3.77162627898118*^9, 3.771626290997555*^9}, {3.771626471915455*^9, 
   3.77162647431002*^9}, {3.771673175223734*^9, 3.771673224278071*^9}, {
   3.771673266441729*^9, 3.77167327762712*^9}, {3.771673352316105*^9, 
   3.771673358322695*^9}, {3.77167341370112*^9, 3.771673438464848*^9}, {
   3.77167350121453*^9, 3.771673525509131*^9}, {3.771673569348257*^9, 
   3.771673571015792*^9}, {3.771673621462082*^9, 3.771673654459712*^9}, {
   3.771673971590723*^9, 3.771673978668692*^9}, 3.7716741398792048`*^9, {
   3.7716743853006973`*^9, 3.7716744014626913`*^9}, 3.7716744754869757`*^9, {
   3.771674530543592*^9, 3.771674536953731*^9}, {3.771674606489312*^9, 
   3.771674718727125*^9}, {3.7716753405724497`*^9, 3.7716754333285303`*^9}, {
   3.771675677951398*^9, 3.771675732879408*^9}, {3.7716934952658777`*^9, 
   3.771693620671177*^9}, {3.771693675046061*^9, 3.771693728576635*^9}, {
   3.771693781310905*^9, 3.771693883952346*^9}, {3.771694119731741*^9, 
   3.771694149933621*^9}, {3.771694304010154*^9, 3.771694425887899*^9}, {
   3.771694474334434*^9, 3.771694494910709*^9}, {3.771694596704371*^9, 
   3.771694598251622*^9}, {3.7716948351254873`*^9, 3.771694920695097*^9}, {
   3.771694969267427*^9, 3.7716949698444967`*^9}, {3.771695031505924*^9, 
   3.771695113745822*^9}, 3.771695177835884*^9, {3.771695213958036*^9, 
   3.771695266066115*^9}, {3.7716954041134243`*^9, 3.771695410898822*^9}, {
   3.771695583126212*^9, 3.771695583229229*^9}, {3.77169977478448*^9, 
   3.771699791270179*^9}, {3.771699867500791*^9, 3.771699871576948*^9}, {
   3.7716999020934553`*^9, 3.771699906117627*^9}, {3.771699974950583*^9, 
   3.771699998868513*^9}, {3.771700029172598*^9, 3.771700059110957*^9}, {
   3.7717001316852818`*^9, 3.771700133480904*^9}, {3.7717001952221823`*^9, 
   3.771700217684945*^9}, {3.771700511884554*^9, 3.771700552476619*^9}, {
   3.771700592591902*^9, 3.771700596013958*^9}, {3.771700698821248*^9, 
   3.7717007012138844`*^9}, {3.771700772107574*^9, 3.771700809173306*^9}, {
   3.77170086753579*^9, 3.77170087085679*^9}, {3.7717009850100393`*^9, 
   3.771701009678179*^9}, {3.7717010664161863`*^9, 3.771701196333969*^9}, {
   3.771701254320465*^9, 3.771701280334656*^9}, {3.77170131268221*^9, 
   3.771701327175708*^9}, {3.7717014657292233`*^9, 3.771701474742733*^9}, {
   3.77170154752151*^9, 3.771701620553605*^9}, {3.771701662420892*^9, 
   3.771701666119358*^9}, {3.771701715617041*^9, 3.771701749865892*^9}, {
   3.771701807376012*^9, 3.7717019223061943`*^9}, {3.771701966969564*^9, 
   3.771701980769197*^9}, {3.771702186095017*^9, 3.771702248928144*^9}, {
   3.771702825562228*^9, 3.771702903638236*^9}, {3.77170297868432*^9, 
   3.771703006267295*^9}, {3.77170332595191*^9, 3.771703351048498*^9}, 
   3.771703613336029*^9, {3.771703648586445*^9, 3.771703667688582*^9}, {
   3.7717037613927603`*^9, 3.771703763946455*^9}, {3.771703934107439*^9, 
   3.771703970399081*^9}, {3.771704119521832*^9, 3.771704151626587*^9}, {
   3.771704195880794*^9, 3.7717041970978518`*^9}, {3.77170455487595*^9, 
   3.771704596558196*^9}, 3.7717047518764133`*^9, {3.7717048365757103`*^9, 
   3.771704861086286*^9}, {3.771704923946967*^9, 3.771704924378716*^9}, 
   3.771704958834386*^9, {3.7717052012613983`*^9, 3.771705202921657*^9}, {
   3.771705240706903*^9, 3.771705291514925*^9}, {3.771705351887005*^9, 
   3.771705367591695*^9}, {3.7717054514478073`*^9, 3.771705464332407*^9}, {
   3.771705497687747*^9, 3.771705506523614*^9}, {3.7717081154580173`*^9, 
   3.771708127804226*^9}, {3.771709391190151*^9, 3.771709392741667*^9}, {
   3.771709499221224*^9, 3.7717095408582783`*^9}, {3.77170957137186*^9, 
   3.771709580184259*^9}, 3.771709635126422*^9, {3.771709706659088*^9, 
   3.7717097100094347`*^9}, {3.771712044671608*^9, 3.7717120455787354`*^9}, 
   3.771712139459732*^9, {3.771712358500682*^9, 3.7717123756141768`*^9}, {
   3.771712436664987*^9, 3.771712509584537*^9}, {3.771712637639783*^9, 
   3.771712648272489*^9}, {3.771712855559021*^9, 3.7717130514849358`*^9}, {
   3.771713084425671*^9, 3.7717131090809507`*^9}, {3.771713141844676*^9, 
   3.771713141969996*^9}, {3.7717132111494617`*^9, 3.7717132253991823`*^9}, {
   3.7717132768409567`*^9, 3.771713278696121*^9}, {3.771713312163457*^9, 
   3.771713313456105*^9}, {3.771713344789674*^9, 3.771713445916922*^9}, {
   3.771714152460678*^9, 3.77171427170189*^9}, {3.771714446749147*^9, 
   3.77171446965423*^9}, 3.771715082386012*^9, 3.7717154473600492`*^9, {
   3.7717712099257917`*^9, 3.771771249706091*^9}, {3.771771286705309*^9, 
   3.7717712887761602`*^9}, {3.863519384611875*^9, 3.8635195225175533`*^9}, 
   3.863519599102813*^9, {3.8635196965982733`*^9, 3.863519730939492*^9}, {
   3.8635200253457336`*^9, 3.863520029576379*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"85630bd6-46aa-4713-81d1-94737fa182d7"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rule Incrementing Functions", "Subsection",
 CellChangeTimes->{{3.863519532936678*^9, 
  3.863519537542882*^9}},ExpressionUUID->"6cfa4382-e90d-462a-88b8-\
9a50eed0f152"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "change", " ", "the", " ", "color", " ", "of", " ", "one", " ", 
    "replacement", " ", "from", " ", "the", " ", "rule"}], " ", "*)"}], "\n", 
  
  RowBox[{
   RowBox[{
    RowBox[{"ruleShift", "[", 
     RowBox[{"rule_", ",", "block_", ",", "shift_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"ruleShift", "[", 
      RowBox[{"rule", ",", "block", ",", "shift"}], "]"}], "=", "\n", "\t", 
     RowBox[{"FromDigits", "[", 
      RowBox[{
       RowBox[{"Mod", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"IntegerDigits", "[", 
           RowBox[{"rule", ",", " ", "colors", ",", " ", "ruleLen"}], "]"}], 
          " ", "+", " ", 
          RowBox[{"SparseArray", "[", 
           RowBox[{
            RowBox[{"block", "\[Rule]", "shift"}], ",", " ", "ruleLen"}], 
           "]"}]}], ",", " ", "colors"}], "]"}], ",", " ", "colors"}], 
      "]"}]}]}], "\n", "\t", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "count", " ", "uses", " ", "of", " ", "each", " ", "block", " ", "of", 
     " ", "the", " ", "rule", " ", "in", " ", "a", " ", "ca"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"countUses", "[", "rule_", "]"}], ":=", 
    RowBox[{
     RowBox[{"countUses", "[", "rule", "]"}], "=", "\n", "\t", 
     RowBox[{"Lookup", "[", 
      RowBox[{
       RowBox[{"Counts", "[", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Partition", "[", 
           RowBox[{
            RowBox[{"cellGrid", "[", "rule", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "]"}], ",", "2"}], "]"}], 
        "]"}], ",", 
       RowBox[{"getBlocks", "[", "]"}], ",", "0"}], "]"}]}]}], "\n", "\t", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
    "order", " ", "of", " ", "blocks", " ", "to", " ", "be", " ", 
     "replaced"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"blockOrder", "[", 
     RowBox[{"rule_", ",", "blocks_", ",", "distance_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Ordering", "[", 
      RowBox[{
       RowBox[{"countUses", "[", "rule", "]"}], ",", 
       RowBox[{"blocks", "+", "distance"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"distance", "+", "1"}], ";;"}], "]"}], "]"}]}], " ", "\n", 
   "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"shift", " ", "one", " ", "block", " ", "of", " ", "rule"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"shifts", "[", 
     RowBox[{"rule_", ",", "block_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ruleShift", "[", 
       RowBox[{"rule", ",", "block", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"Table", "[", 
      RowBox[{"i", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"colors", "-", "1"}]}], "}"}]}], "]"}]}]}], " ", "\n", "\n", 
   
   RowBox[{"(*", " ", 
    RowBox[{
    "make", " ", "a", " ", "tree", " ", "of", " ", "associations", " ", "for",
      " ", "all", " ", "specified", " ", "rule", " ", "replacements"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"iterateRules", "[", 
     RowBox[{"rule_", ",", 
      RowBox[{"{", "}"}]}], "]"}], ":=", "rule"}], "\n", 
   RowBox[{
    RowBox[{"iterateRules", "[", 
     RowBox[{"rule_", ",", "reps_"}], "]"}], ":=", "\n", "\t", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"rule", "\[Rule]", 
        RowBox[{"iterateRules", "[", 
         RowBox[{"#", ",", 
          RowBox[{"Rest", "[", "reps", "]"}]}], "]"}]}], "&"}], ",", 
      RowBox[{"shifts", "[", 
       RowBox[{"rule", ",", 
        RowBox[{"First", "[", "reps", "]"}]}], "]"}]}], "]"}]}], " ", "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "make", " ", "map", " ", "suitable", " ", "for", " ", "graphing"}], " ", 
    "*)"}], "\n", 
   RowBox[{
    RowBox[{"connections", "[", "rule_", "]"}], ":=", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"iterateRules", "[", 
        RowBox[{"rule", ",", 
         RowBox[{"blockOrder", "[", 
          RowBox[{"rule", ",", "blocks", ",", "distance"}], "]"}]}], "]"}], "//.", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{"a_", ",", 
          RowBox[{"{", "b__Rule", "}"}]}], "]"}], ":>", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{"a", ",", "#"}], "]"}], "&"}], "/@", 
           RowBox[{"Keys", "[", 
            RowBox[{"{", "b", "}"}], "]"}]}], ",", "b"}], "}"}]}]}], "//", 
      "Flatten"}], "//", "DeleteDuplicates", " "}]}]}]}]], "Code",
 CellChangeTimes->{{3.770482787643997*^9, 3.770482921097328*^9}, {
   3.770482959794046*^9, 3.770483062443226*^9}, {3.770483139105879*^9, 
   3.770483142791513*^9}, {3.7704833713411627`*^9, 3.770483604393207*^9}, {
   3.770483652477036*^9, 3.770483668514173*^9}, {3.7704837314588003`*^9, 
   3.770483760241007*^9}, {3.77048379348855*^9, 3.770483818784292*^9}, {
   3.770483886037365*^9, 3.77048391704599*^9}, {3.770483982730173*^9, 
   3.770484041007475*^9}, {3.77048412028379*^9, 3.7704841228226023`*^9}, {
   3.770484218139017*^9, 3.770484239373794*^9}, {3.7704842830675592`*^9, 
   3.770484335072513*^9}, {3.770484689868153*^9, 3.770484707338176*^9}, {
   3.7704858240605583`*^9, 3.77048583343545*^9}, {3.77048590141014*^9, 
   3.770485901723312*^9}, {3.770486365317235*^9, 3.7704863665313587`*^9}, 
   3.770494386502613*^9, {3.770494470707664*^9, 3.770494645630993*^9}, {
   3.770494689386427*^9, 3.770494765588149*^9}, {3.7704948516503*^9, 
   3.770494888375936*^9}, {3.770494921269123*^9, 3.770495029608489*^9}, {
   3.7704950624466133`*^9, 3.770495141583098*^9}, {3.77049519230225*^9, 
   3.7704952643574133`*^9}, {3.770495449922097*^9, 3.7704955008340197`*^9}, {
   3.770495564766152*^9, 3.770495578779191*^9}, {3.770495620880939*^9, 
   3.770495654324613*^9}, 3.770546148986672*^9, 3.7705464136378736`*^9, {
   3.7705464597370453`*^9, 3.770546469723206*^9}, {3.770546510288927*^9, 
   3.770546531072365*^9}, {3.7705499059866543`*^9, 3.7705499209635277`*^9}, {
   3.770646995775899*^9, 3.770647162029993*^9}, {3.770647226016552*^9, 
   3.7706472960607977`*^9}, {3.770647344322225*^9, 3.770647427912814*^9}, {
   3.7706474763262453`*^9, 3.7706475285312357`*^9}, {3.770647579226934*^9, 
   3.7706475825076523`*^9}, {3.770647635720187*^9, 3.770647641473075*^9}, {
   3.770647712413559*^9, 3.77064771712294*^9}, {3.770647863127544*^9, 
   3.770647865474045*^9}, {3.770648147609572*^9, 3.7706481483061523`*^9}, {
   3.770648194531769*^9, 3.77064819764957*^9}, {3.7706482295255404`*^9, 
   3.770648251796324*^9}, {3.770648285676703*^9, 3.770648287071795*^9}, {
   3.7706483844894037`*^9, 3.770648408310869*^9}, {3.770648474457296*^9, 
   3.77064849181185*^9}, {3.77064919951954*^9, 3.770649219260521*^9}, {
   3.771012572080574*^9, 3.771012574557795*^9}, {3.7710130892382*^9, 
   3.7710131278577003`*^9}, {3.771013164671421*^9, 3.771013170662612*^9}, {
   3.771013241398697*^9, 3.771013293093876*^9}, {3.771013376828169*^9, 
   3.771013408917551*^9}, {3.771066027911306*^9, 3.7710660563644667`*^9}, {
   3.771066088967906*^9, 3.771066126393922*^9}, {3.771066304209084*^9, 
   3.771066417760647*^9}, {3.7710665061651993`*^9, 3.77106651827633*^9}, {
   3.7710665958461657`*^9, 3.771066599592246*^9}, {3.771066787106886*^9, 
   3.77106688118673*^9}, {3.771066917958227*^9, 3.771066920163258*^9}, {
   3.771066961041355*^9, 3.7710669697386007`*^9}, {3.771067019870351*^9, 
   3.771067054186266*^9}, {3.771067596745988*^9, 3.771067608539199*^9}, {
   3.7710677999321203`*^9, 3.771067828462199*^9}, {3.7710691448181763`*^9, 
   3.771069146191324*^9}, {3.771069401140826*^9, 3.7710694192296677`*^9}, {
   3.7710694544712057`*^9, 3.77106946175102*^9}, {3.771069510407185*^9, 
   3.771069546377035*^9}, {3.771069588713119*^9, 3.771069623729661*^9}, {
   3.7710777912034283`*^9, 3.771077797514872*^9}, {3.771077857747775*^9, 
   3.771077896683793*^9}, {3.7710779846984587`*^9, 3.7710780571582336`*^9}, {
   3.7710780916296473`*^9, 3.771078093185443*^9}, {3.771078157306479*^9, 
   3.7710783469069242`*^9}, {3.771078546205811*^9, 3.771078555275388*^9}, 
   3.771078785346652*^9, {3.771079086436943*^9, 3.771079086531608*^9}, {
   3.7710792132061577`*^9, 3.771079264419251*^9}, {3.7710796746024218`*^9, 
   3.77107985049893*^9}, {3.771079980556774*^9, 3.77108000254884*^9}, {
   3.771080037566615*^9, 3.771080126810281*^9}, {3.7710801647208*^9, 
   3.7710801660741787`*^9}, {3.771080197507674*^9, 3.7710802250598183`*^9}, {
   3.771080267960541*^9, 3.771080359083398*^9}, {3.771080406249712*^9, 
   3.771080421234771*^9}, {3.7710804782287493`*^9, 3.771080592180871*^9}, {
   3.7710806420884533`*^9, 3.771080643782098*^9}, {3.771080707357484*^9, 
   3.7710807526840153`*^9}, {3.771080786460499*^9, 3.7710807865927343`*^9}, {
   3.771080854778215*^9, 3.77108095974751*^9}, {3.7710810202456903`*^9, 
   3.771081023112467*^9}, {3.771081074111945*^9, 3.7710810835969048`*^9}, {
   3.7710813979098043`*^9, 3.771081432278171*^9}, {3.771081466981485*^9, 
   3.7710814671031923`*^9}, {3.771081505139979*^9, 3.771081583240635*^9}, {
   3.771081685649589*^9, 3.771081701105802*^9}, {3.771081759414233*^9, 
   3.771081781046382*^9}, {3.771081920400188*^9, 3.771081923433948*^9}, {
   3.771102715133277*^9, 3.7711027957900267`*^9}, {3.771102842399693*^9, 
   3.771102881808381*^9}, {3.771102929227768*^9, 3.7711029691401367`*^9}, {
   3.771103073447472*^9, 3.771103086180725*^9}, {3.7711031176933737`*^9, 
   3.771103123767542*^9}, {3.7711031660546627`*^9, 3.7711031834026413`*^9}, {
   3.7711032291580553`*^9, 3.7711034631767817`*^9}, {3.771103551409133*^9, 
   3.7711035565488443`*^9}, {3.771103589768116*^9, 3.771103643377743*^9}, {
   3.771104123721092*^9, 3.7711041535912523`*^9}, 3.7711042972171087`*^9, {
   3.771104442098654*^9, 3.7711044613789263`*^9}, {3.77110469507471*^9, 
   3.771104742941822*^9}, {3.771104774170217*^9, 3.77110482732683*^9}, {
   3.771155075730083*^9, 3.77115510319302*^9}, {3.7711552204793873`*^9, 
   3.771155256265522*^9}, {3.771155315803068*^9, 3.771155317177318*^9}, {
   3.771155352667796*^9, 3.7711554504442596`*^9}, {3.771155487442925*^9, 
   3.771155490673388*^9}, {3.771155532866001*^9, 3.7711555903371677`*^9}, {
   3.771155628649703*^9, 3.771155834814893*^9}, {3.7711558698054256`*^9, 
   3.7711559269158163`*^9}, 3.7711559705399923`*^9, {3.771156007382532*^9, 
   3.771156011094149*^9}, {3.771156048765955*^9, 3.771156049264926*^9}, {
   3.771156096767069*^9, 3.771156096825408*^9}, {3.7711561514908113`*^9, 
   3.77115623471835*^9}, {3.771156280227399*^9, 3.771156289782609*^9}, {
   3.771156373415247*^9, 3.7711563734818172`*^9}, {3.771156419112504*^9, 
   3.771156440871361*^9}, {3.771156495007992*^9, 3.7711565545108624`*^9}, {
   3.771156592609713*^9, 3.7711565927161903`*^9}, {3.771156768188053*^9, 
   3.771156795051096*^9}, 3.771156999731532*^9, {3.771157045274468*^9, 
   3.771157045541771*^9}, {3.771157114755713*^9, 3.771157137928946*^9}, 
   3.7711600338876333`*^9, {3.771242096819364*^9, 3.771242126195787*^9}, {
   3.771242256031309*^9, 3.771242258590022*^9}, {3.771242409531823*^9, 
   3.771242427172946*^9}, {3.771242887847391*^9, 3.7712430086268187`*^9}, 
   3.7712430584239273`*^9, {3.771243106934415*^9, 3.771243107568427*^9}, {
   3.7712431714277573`*^9, 3.771243197952642*^9}, {3.771244552432255*^9, 
   3.771244577042035*^9}, {3.77142514036493*^9, 3.771425142502884*^9}, {
   3.7714251943895397`*^9, 3.771425215829914*^9}, {3.77142527264194*^9, 
   3.7714253037709*^9}, {3.771425370795764*^9, 3.771425408257433*^9}, {
   3.771425440099287*^9, 3.7714254402688704`*^9}, {3.771425473750928*^9, 
   3.7714255960830173`*^9}, {3.771425631818544*^9, 3.771425675253339*^9}, {
   3.771425719721884*^9, 3.771425740883687*^9}, {3.77142580515589*^9, 
   3.7714258447466307`*^9}, {3.771425981145659*^9, 3.771426077771694*^9}, {
   3.771426125827806*^9, 3.771426127166316*^9}, {3.7714261869034653`*^9, 
   3.77142620723772*^9}, {3.7714262758003807`*^9, 3.77142627714293*^9}, {
   3.771426320226757*^9, 3.771426324649633*^9}, {3.771426394553677*^9, 
   3.771426422846036*^9}, {3.7714264814633904`*^9, 3.771426484560677*^9}, {
   3.7714265255888844`*^9, 3.77142656450191*^9}, {3.77142666832382*^9, 
   3.771426701226253*^9}, {3.7714267992888727`*^9, 3.771426802098439*^9}, {
   3.771426837696424*^9, 3.77142684252494*^9}, {3.771426881502282*^9, 
   3.77142689463704*^9}, {3.771426944474209*^9, 3.771426954837367*^9}, {
   3.771427085611624*^9, 3.771427208321937*^9}, {3.77142725982743*^9, 
   3.771427342676564*^9}, {3.771427387096983*^9, 3.77142741387674*^9}, {
   3.7714274823067417`*^9, 3.771427620083233*^9}, {3.771427650958089*^9, 
   3.771427735642126*^9}, {3.771427811732935*^9, 3.7714278281384907`*^9}, {
   3.771427984750801*^9, 3.771428010767819*^9}, {3.771428145789899*^9, 
   3.771428219232523*^9}, {3.77142845337399*^9, 3.771428832443232*^9}, {
   3.77142919635216*^9, 3.7714292167538853`*^9}, {3.771429255809939*^9, 
   3.771429255862849*^9}, {3.771429324211997*^9, 3.771429324566071*^9}, {
   3.771429398212832*^9, 3.771429402512352*^9}, {3.771429442429163*^9, 
   3.7714294540990467`*^9}, 3.7714294941500063`*^9, {3.771429539657894*^9, 
   3.7714295405513687`*^9}, {3.771429618724918*^9, 3.771429623261997*^9}, {
   3.7714307899835873`*^9, 3.771430790436494*^9}, 3.771451104216363*^9, {
   3.771508095448917*^9, 3.771508110132432*^9}, {3.7715083225896187`*^9, 
   3.7715083306779222`*^9}, {3.771508374776663*^9, 3.771508386277514*^9}, {
   3.7715084270778646`*^9, 3.771508512389296*^9}, 3.771508543555127*^9, {
   3.77150858570796*^9, 3.771508618994934*^9}, {3.7715088207169943`*^9, 
   3.77150889031539*^9}, {3.771508923322143*^9, 3.771508923670087*^9}, 
   3.771508953753009*^9, 3.771509016175152*^9, 3.7715091247344227`*^9, {
   3.771509280836137*^9, 3.7715093899531307`*^9}, {3.771509422527775*^9, 
   3.771509422567185*^9}, {3.771509493986957*^9, 3.7715096052550087`*^9}, {
   3.771509653971591*^9, 3.771509693979186*^9}, {3.77150973259478*^9, 
   3.77150990173524*^9}, {3.771510004414825*^9, 3.771510008024968*^9}, 
   3.771510097994895*^9, 3.771510166795833*^9, 3.771510435525115*^9, {
   3.771510592878343*^9, 3.7715105957468767`*^9}, {3.7715107677541*^9, 
   3.771510769561739*^9}, {3.77151081284661*^9, 3.7715108155415583`*^9}, {
   3.7715108821134987`*^9, 3.7715109302915382`*^9}, {3.771510964009658*^9, 
   3.771510971129046*^9}, {3.771511010046406*^9, 3.7715110353755198`*^9}, {
   3.771511088136096*^9, 3.771511102886223*^9}, {3.7715114300949583`*^9, 
   3.771511430126233*^9}, {3.771511497625127*^9, 3.7715115693777018`*^9}, {
   3.771511643172413*^9, 3.771511646783353*^9}, {3.771511678993891*^9, 
   3.771511680277672*^9}, 3.7715127192809067`*^9, {3.771512800048661*^9, 
   3.7715128026246967`*^9}, {3.771512870902679*^9, 3.771512913650139*^9}, {
   3.7715133261672697`*^9, 3.7715133314839773`*^9}, 3.771513492252378*^9, {
   3.771514518198213*^9, 3.7715145227679043`*^9}, {3.77151708493652*^9, 
   3.771517087523554*^9}, {3.771517126782735*^9, 3.771517128810008*^9}, {
   3.771517210341956*^9, 3.7715172460665407`*^9}, {3.771517282285139*^9, 
   3.7715173175659246`*^9}, {3.771517350871862*^9, 3.771517380625053*^9}, {
   3.7715175364523573`*^9, 3.77151760571542*^9}, {3.771517640074253*^9, 
   3.7715176411021967`*^9}, {3.7715176899659986`*^9, 3.771517690090538*^9}, {
   3.7715177712211246`*^9, 3.771517772849249*^9}, 3.7715179959744*^9, {
   3.771518135783963*^9, 3.771518137899392*^9}, {3.7715184814367847`*^9, 
   3.771518486933831*^9}, {3.771518845518941*^9, 3.771518853375394*^9}, {
   3.771519841748459*^9, 3.771519843226256*^9}, {3.771520014828779*^9, 
   3.771520023308147*^9}, {3.771520059011042*^9, 3.7715201019782476`*^9}, {
   3.771520273028158*^9, 3.771520279593449*^9}, {3.771520883693551*^9, 
   3.7715208856464148`*^9}, {3.771520929250544*^9, 3.771520982269124*^9}, {
   3.771521188240921*^9, 3.771521191230611*^9}, {3.7715215916037903`*^9, 
   3.7715216236153183`*^9}, {3.7715219556354227`*^9, 
   3.7715219569119167`*^9}, {3.7715219940893173`*^9, 3.771522004818063*^9}, {
   3.771522127564417*^9, 3.771522133178886*^9}, {3.771522237696827*^9, 
   3.771522242483397*^9}, {3.771522476907035*^9, 3.7715224806870003`*^9}, {
   3.771612023511445*^9, 3.771612031753702*^9}, {3.771612079472707*^9, 
   3.7716120893051157`*^9}, {3.7716224793342648`*^9, 3.771622480136241*^9}, {
   3.771622883240336*^9, 3.7716228933155813`*^9}, {3.7716237449938374`*^9, 
   3.771623747126918*^9}, {3.771623796412709*^9, 3.771623799136798*^9}, {
   3.771624309956813*^9, 3.771624313155792*^9}, {3.7716243671319427`*^9, 
   3.771624385215858*^9}, {3.7716254457528887`*^9, 3.7716254552861023`*^9}, {
   3.77162627898118*^9, 3.771626290997555*^9}, {3.771626471915455*^9, 
   3.77162647431002*^9}, {3.771673175223734*^9, 3.771673224278071*^9}, {
   3.771673266441729*^9, 3.77167327762712*^9}, {3.771673352316105*^9, 
   3.771673358322695*^9}, {3.77167341370112*^9, 3.771673438464848*^9}, {
   3.77167350121453*^9, 3.771673525509131*^9}, {3.771673569348257*^9, 
   3.771673571015792*^9}, {3.771673621462082*^9, 3.771673654459712*^9}, {
   3.771673971590723*^9, 3.771673978668692*^9}, 3.7716741398792048`*^9, {
   3.7716743853006973`*^9, 3.7716744014626913`*^9}, 3.7716744754869757`*^9, {
   3.771674530543592*^9, 3.771674536953731*^9}, {3.771674606489312*^9, 
   3.771674718727125*^9}, {3.7716753405724497`*^9, 3.7716754333285303`*^9}, {
   3.771675677951398*^9, 3.771675732879408*^9}, {3.7716934952658777`*^9, 
   3.771693620671177*^9}, {3.771693675046061*^9, 3.771693728576635*^9}, {
   3.771693781310905*^9, 3.771693883952346*^9}, {3.771694119731741*^9, 
   3.771694149933621*^9}, {3.771694304010154*^9, 3.771694425887899*^9}, {
   3.771694474334434*^9, 3.771694494910709*^9}, {3.771694596704371*^9, 
   3.771694598251622*^9}, {3.7716948351254873`*^9, 3.771694920695097*^9}, {
   3.771694969267427*^9, 3.7716949698444967`*^9}, {3.771695031505924*^9, 
   3.771695113745822*^9}, 3.771695177835884*^9, {3.771695213958036*^9, 
   3.771695266066115*^9}, {3.7716954041134243`*^9, 3.771695410898822*^9}, {
   3.771695583126212*^9, 3.771695583229229*^9}, {3.77169977478448*^9, 
   3.771699791270179*^9}, {3.771699867500791*^9, 3.771699871576948*^9}, {
   3.7716999020934553`*^9, 3.771699906117627*^9}, {3.771699974950583*^9, 
   3.771699998868513*^9}, {3.771700029172598*^9, 3.771700059110957*^9}, {
   3.7717001316852818`*^9, 3.771700133480904*^9}, {3.7717001952221823`*^9, 
   3.771700217684945*^9}, {3.771700511884554*^9, 3.771700552476619*^9}, {
   3.771700592591902*^9, 3.771700596013958*^9}, {3.771700698821248*^9, 
   3.7717007012138844`*^9}, {3.771700772107574*^9, 3.771700809173306*^9}, {
   3.77170086753579*^9, 3.77170087085679*^9}, {3.7717009850100393`*^9, 
   3.771701009678179*^9}, {3.7717010664161863`*^9, 3.771701196333969*^9}, {
   3.771701254320465*^9, 3.771701280334656*^9}, {3.77170131268221*^9, 
   3.771701327175708*^9}, {3.7717014657292233`*^9, 3.771701474742733*^9}, {
   3.77170154752151*^9, 3.771701620553605*^9}, {3.771701662420892*^9, 
   3.771701666119358*^9}, {3.771701715617041*^9, 3.771701749865892*^9}, {
   3.771701807376012*^9, 3.7717019223061943`*^9}, {3.771701966969564*^9, 
   3.771701980769197*^9}, {3.771702186095017*^9, 3.771702248928144*^9}, {
   3.771702825562228*^9, 3.771702903638236*^9}, {3.77170297868432*^9, 
   3.771703006267295*^9}, {3.77170332595191*^9, 3.771703351048498*^9}, 
   3.771703613336029*^9, {3.771703648586445*^9, 3.771703667688582*^9}, {
   3.7717037613927603`*^9, 3.771703763946455*^9}, {3.771703934107439*^9, 
   3.771703970399081*^9}, {3.771704119521832*^9, 3.771704151626587*^9}, {
   3.771704195880794*^9, 3.7717041970978518`*^9}, {3.77170455487595*^9, 
   3.771704596558196*^9}, 3.7717047518764133`*^9, {3.7717048365757103`*^9, 
   3.771704861086286*^9}, {3.771704923946967*^9, 3.771704924378716*^9}, 
   3.771704958834386*^9, {3.7717052012613983`*^9, 3.771705202921657*^9}, {
   3.771705240706903*^9, 3.771705291514925*^9}, {3.771705351887005*^9, 
   3.771705367591695*^9}, {3.7717054514478073`*^9, 3.771705464332407*^9}, {
   3.771705497687747*^9, 3.771705506523614*^9}, {3.7717081154580173`*^9, 
   3.771708127804226*^9}, {3.771709391190151*^9, 3.771709392741667*^9}, {
   3.771709499221224*^9, 3.7717095408582783`*^9}, {3.77170957137186*^9, 
   3.771709580184259*^9}, 3.771709635126422*^9, {3.771709706659088*^9, 
   3.7717097100094347`*^9}, {3.771712044671608*^9, 3.7717120455787354`*^9}, 
   3.771712139459732*^9, {3.771712358500682*^9, 3.7717123756141768`*^9}, {
   3.771712436664987*^9, 3.771712509584537*^9}, {3.771712637639783*^9, 
   3.771712648272489*^9}, {3.771712855559021*^9, 3.7717130514849358`*^9}, {
   3.771713084425671*^9, 3.7717131090809507`*^9}, {3.771713141844676*^9, 
   3.771713141969996*^9}, {3.7717132111494617`*^9, 3.7717132253991823`*^9}, {
   3.7717132768409567`*^9, 3.771713278696121*^9}, {3.771713312163457*^9, 
   3.771713313456105*^9}, {3.771713344789674*^9, 3.771713445916922*^9}, {
   3.771714152460678*^9, 3.77171427170189*^9}, {3.771714446749147*^9, 
   3.77171446965423*^9}, 3.771715082386012*^9, 3.7717154473600492`*^9, {
   3.771768861292097*^9, 3.7717689354542913`*^9}, {3.77176955694038*^9, 
   3.771769612806575*^9}, 3.771771072817876*^9, {3.863519530904529*^9, 
   3.8635196461997833`*^9}, {3.863520055616123*^9, 3.863520055826187*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"5fb13b81-7d4f-4919-9146-b9d82449e1fc"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Density Task", "Section",
 CellChangeTimes->{{3.865086432252376*^9, 
  3.865086433632963*^9}},ExpressionUUID->"98f29562-6b2a-4b77-8959-\
c9c8c1525bb3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"getMajority", "[", "init_", "]"}], " ", ":=", " ", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Total", "[", "init", "]"}], " ", ">", " ", 
     RowBox[{
      RowBox[{"Length", "[", "init", "]"}], " ", "/", " ", "2"}]}], ",", " ", 
    "1", ",", " ", "0"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getError", "[", 
   RowBox[{"result_", ",", " ", "majority_"}], "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Total", "[", 
     RowBox[{"Abs", "[", 
      RowBox[{"result", " ", "-", " ", 
       RowBox[{"Table", "[", 
        RowBox[{"majority", ",", " ", 
         RowBox[{"Length", " ", "@", " ", "result"}]}], "]"}]}], "]"}], "]"}],
     " ", "/", " ", 
    RowBox[{"Length", "[", "result", "]"}]}], " ", "//", " ", "N"}]}], "\n", 
 RowBox[{
  RowBox[{"getResult", "[", 
   RowBox[{"init_", ",", " ", "rule_"}], "]"}], " ", ":=", " ", 
  RowBox[{"FixedPoint", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"CellularAutomaton", "[", 
      RowBox[{"rule", ",", " ", "#"}], "]"}], "&"}], ",", " ", "init", ",", 
    " ", "maxSteps"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"getRule", "[", 
   RowBox[{"k_", ",", " ", "r_"}], "]"}], " ", ":=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"RandomInteger", "[", 
     RowBox[{
      RowBox[{"k", "^", 
       RowBox[{"k", "^", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", "r"}], "+", "1"}], ")"}]}]}], "-", "1"}], "]"}], ",", 
    " ", "k", ",", " ", "r"}], "}"}]}]}], "Code",
 CellChangeTimes->{{3.865084793493145*^9, 3.8650848056506844`*^9}, {
  3.865084836721035*^9, 3.865084872187553*^9}, {3.8650856325601263`*^9, 
  3.865085686285659*^9}, {3.8650857481071978`*^9, 3.8650857992008133`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"16d4e5a5-f358-4e59-a3a0-ce74d30d21c4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"size", " ", "=", " ", "49"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxSteps", " ", "=", " ", "101"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rule", " ", "=", " ", 
   RowBox[{"getRule", "[", 
    RowBox[{"k", ",", "r"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", " ", "=", " ", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"k", "-", "1"}], ",", " ", "size"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"majority", " ", "=", " ", 
   RowBox[{"getMajority", "[", "init", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", " ", "=", " ", 
   RowBox[{"getResult", "[", 
    RowBox[{"init", ",", " ", "rule"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"error", " ", "=", " ", 
   RowBox[{"getError", "[", 
    RowBox[{"result", ",", " ", "majority"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8650856974229116`*^9, 3.865085811469964*^9}},
 CellLabel->
  "In[211]:=",ExpressionUUID->"8b349fdc-dcdd-4aba-b794-2b6b36d86cfc"]
}, Open  ]]
},
WindowSize->{1069, 764},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.3 for Mac OS X ARM (64-bit) (July 9, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"e0cd0168-c64e-4ffd-806d-610c57a3251d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 171, 3, 67, "Section",ExpressionUUID->"4b052983-f7eb-4c60-b94e-63384307ec0d"],
Cell[CellGroupData[{
Cell[776, 29, 153, 2, 54, "Subsection",ExpressionUUID->"ce98e1f7-7289-409a-af7d-0f02a4d912ab"],
Cell[932, 33, 12842, 200, 148, "Code",ExpressionUUID->"8bf4f650-2ca6-49e6-856b-3ffd0cb6832a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13811, 238, 167, 3, 54, "Subsection",ExpressionUUID->"4c8aaee8-1ce5-4656-857a-0898d5b45ada"],
Cell[13981, 243, 20821, 333, 585, "Code",ExpressionUUID->"85630bd6-46aa-4713-81d1-94737fa182d7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34839, 581, 175, 3, 54, "Subsection",ExpressionUUID->"6cfa4382-e90d-462a-88b8-9a50eed0f152"],
Cell[35017, 586, 21373, 356, 452, "Code",ExpressionUUID->"5fb13b81-7d4f-4919-9146-b9d82449e1fc"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56439, 948, 157, 3, 67, "Section",ExpressionUUID->"98f29562-6b2a-4b77-8959-c9c8c1525bb3"],
Cell[56599, 953, 1807, 49, 110, "Code",ExpressionUUID->"16d4e5a5-f358-4e59-a3a0-ce74d30d21c4"],
Cell[58409, 1004, 1228, 33, 199, "Input",ExpressionUUID->"8b349fdc-dcdd-4aba-b794-2b6b36d86cfc"]
}, Open  ]]
}
]
*)

